<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started • patentsview</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started">
<meta property="og:description" content="patentsview">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">patentsview</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../articles/articles/getting-started.html">
    <span class="fas fa-play"></span>
     
    Getting started
  </a>
</li>
<li>
  <a href="../../articles/articles/writing-queries.html">
    <span class="fas fa-pencil"></span>
     
    Writing queries
  </a>
</li>
<li>
  <a href="../../articles/articles/examples.html">
    <span class="fas fa-code"></span>
     
    Examples
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-bar-chart"></span>
     
    Applications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/top-assignees.html">
        <span class="fas fa-university"></span>
         
        Top assignees
      </a>
    </li>
    <li>
      <a href="../../articles/articles/citation-networks.html">
        <span class="fas fa-long-arrow-left"></span>
         
        Citation networks
      </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../reference/index.html">
    <span class="fas fa-info-circle"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="https://github.com/ropensci/patentsview">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="getting-started_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/master/vignettes/articles/getting-started.Rmd"><code>vignettes/articles/getting-started.Rmd</code></a></small>
      <div class="hidden name"><code>getting-started.Rmd</code></div>

    </div>

    
    
<div id="a-basic-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-basic-example" class="anchor"></a>A basic example</h2>
<p>Let’s start with a basic example of how to use the package’s primary function, <code><a href="../../reference/search_pv.html">search_pv()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/patentsview/index.html">patentsview</a></span><span class="op">)</span>

<span class="fu"><a href="../../reference/search_pv.html">search_pv</a></span><span class="op">(</span>
  query <span class="op">=</span> <span class="st">'{"_gte":{"patent_date":"2007-01-01"}}'</span>,
  endpoint <span class="op">=</span> <span class="st">"patents"</span>
<span class="op">)</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; #### A list with a single data frame on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 24 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ patent_id    : chr [1:24] "10000001" ...</span>
<span class="co">#&gt;   ..$ patent_number: chr [1:24] "10000001" ...</span>
<span class="co">#&gt;   ..$ patent_title : chr [1:24] "Injection molding machine and mold thickness"..</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_patent_count = 100,000</span></code></pre></div>
<p>This call to <code><a href="../../reference/search_pv.html">search_pv()</a></code> sends our query to the patents endpoint (the default). The API has 7 different endpoints, corresponding to 7 different entity types (assignees, CPC subsections, inventors, locations, NBER subcategories, patents, and USPC main classes).<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Your choice of endpoint determines which entity your query is applied to, as well as the structure of the data that is returned (more on this in the “7 endpoints for 7 entities section”). For now, let’s turn our attention to the <code>query</code> parameter.</p>
</div>
<div id="writing-queries" class="section level2">
<h2 class="hasAnchor">
<a href="#writing-queries" class="anchor"></a>Writing queries</h2>
<p>The PatentsView query syntax is documented on their <a href="http://www.patentsview.org/api/query-language.html#query_string_format">query language page</a>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> However, it can be difficult to get your query right if you’re writing it by hand (i.e., just writing the query in a string like <code>'{"_gte":{"patent_date":"2007-01-01"}}'</code>, as we did in the example shown above). The <code>patentsview</code> package comes with a simple domain specific language (DSL) to make writing queries a breeze. I recommend using the functions in this DSL for all but the most basic queries, especially if you’re encountering errors and don’t understand why. To get a feel for how it works, let’s rewrite the query shown above using one of the functions in the DSL, <code>qry_funs$gte()</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qry_funs</span><span class="op">$</span><span class="fu">gte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2007-01-01"</span><span class="op">)</span>
<span class="co">#&gt; {"_gte":{"patent_date":"2007-01-01"}}</span></code></pre></div>
<p>More complex queries are also possible:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span>
  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">and</a></span><span class="op">(</span>
    <span class="fu">gte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2007-01-01"</span><span class="op">)</span>,
    <span class="fu">text_phrase</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"computer program"</span>, <span class="st">"dog leash"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; {"_and":[{"_gte":{"patent_date":"2007-01-01"}},{"_or":[{"_text_phrase":{"patent_abstract":"computer program"}},{"_text_phrase":{"patent_abstract":"dog leash"}}]}]}</span></code></pre></div>
<p>Check out the <a href="https://docs.ropensci.org/patentsview/articles/writing-queries.html">writing queries vignette</a> for more details on using the DSL.</p>
</div>
<div id="fields" class="section level2">
<h2 class="hasAnchor">
<a href="#fields" class="anchor"></a>Fields</h2>
<p>Each endpoint has a different set of <em>queryable</em> and <em>retrievable</em> fields. Queryable fields are those that you can include in your query (e.g., <code>patent_date</code> shown in the first example). Retrievable fields are those that you can get data on (i.e., fields returned by <code><a href="../../reference/search_pv.html">search_pv()</a></code>). In the first example, we didn’t specify which fields we wanted to retrieve so we were given the default set. You can specify which fields you want using the <code>fields</code> argument:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/search_pv.html">search_pv</a></span><span class="op">(</span>
  query <span class="op">=</span> <span class="st">'{"_gte":{"patent_date":"2007-01-01"}}'</span>,
  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"patent_number"</span>, <span class="st">"patent_title"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; #### A list with a single data frame on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 24 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ patent_number: chr [1:24] "10000001" ...</span>
<span class="co">#&gt;   ..$ patent_title : chr [1:24] "Injection molding machine and mold thickness"..</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_patent_count = 100,000</span></code></pre></div>
<p>To list all of the retrievable fields for a given endpoint, use <code><a href="../../reference/get_fields.html">get_fields()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">retrvble_flds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patents"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">retrvble_flds</span><span class="op">)</span>
<span class="co">#&gt; [1] "appcit_app_number" "appcit_category"   "appcit_date"      </span>
<span class="co">#&gt; [4] "appcit_kind"       "appcit_sequence"   "app_country"</span></code></pre></div>
<p>You can also visit an endpoint’s online documentation page to see a list of its queryable and retrievable fields (e.g., see the <a href="http://www.patentsview.org/api/inventor.html#field_list">inventor field list table</a>). Note the “Query” column in this table, which indicates whether the field is both queryable and retrievable (Query = Y), or just retrievable (Query = N). The field tables for all of the endpoints can be found in the <code>fieldsdf</code> data frame, which you can load using <code><a href="https://rdrr.io/r/utils/data.html">data("fieldsdf")</a></code> or <code><a href="https://rdrr.io/r/utils/View.html">View(patentsview::fieldsdf)</a></code>.</p>
<p><strong>An important note: By default, PatentsView uses disambiguted versions of assignees, inventors, and locations, instead of raw data.</strong> For example, let’s say you search for all inventors whose first name is “john.” The PatentsView API is going to return all of the inventors who have a preferred first name (as per the disambiguation results) of john, which may not necessarily be their raw first name. You could be getting back inventors whose first name appears on the patent as, say, “jonathan,” “johnn,” or even “john jay.” You can search on the raw inventor names instead of the preferred names by using the fields starting with “raw” in your query (e.g., <code>rawinventor_first_name</code>). The assignee and location raw data fields are not currently being offered by the API. To see the methods behind the disambiguation process, see the <a href="http://www.patentsview.org/workshop/">PatentsView Inventor Disambiguation Technical Workshop website</a>.</p>
</div>
<div id="paginated-responses" class="section level2">
<h2 class="hasAnchor">
<a href="#paginated-responses" class="anchor"></a>Paginated responses</h2>
<p>By default, <code><a href="../../reference/search_pv.html">search_pv()</a></code> returns 25 records per page and only gives you the first page of results. I suggest sticking with these defaults while you’re figuring out the details of your request, such as the query you want to use and the fields you want returned. Once you have those items finalized, you can use the <code>per_page</code> argument to download up to 10,000 records per page. You can also choose which page of results you want with the <code>page</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/search_pv.html">search_pv</a></span><span class="op">(</span>
  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventor_last_name <span class="op">=</span> <span class="st">"chambers"</span><span class="op">)</span>,
  page <span class="op">=</span> <span class="fl">2</span>, per_page <span class="op">=</span> <span class="fl">150</span> <span class="co"># gets records 150 - 300</span>
<span class="op">)</span> 
<span class="co">#&gt; $data</span>
<span class="co">#&gt; #### A list with a single data frame on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 150 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ patent_id    : chr [1:150] "10577927" ...</span>
<span class="co">#&gt;   ..$ patent_number: chr [1:150] "10577927" ...</span>
<span class="co">#&gt;   ..$ patent_title : chr [1:150] "Mud pulse telemetry tool comprising a low t"..</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_patent_count = 2,208</span></code></pre></div>
<p>You can download all pages of output in one call by setting <code>all_pages = TRUE</code>. This will set <code>per_page</code> equal to 10,000 and loop over all pages of output (downloading up to 10 pages, or 100,000 records total):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/search_pv.html">search_pv</a></span><span class="op">(</span>
  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventor_last_name <span class="op">=</span> <span class="st">"chambers"</span><span class="op">)</span>,
  all_pages <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; #### A list with a single data frame on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 2208 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ patent_id    : chr [1:2208] "10000988" ...</span>
<span class="co">#&gt;   ..$ patent_number: chr [1:2208] "10000988" ...</span>
<span class="co">#&gt;   ..$ patent_title : chr [1:2208] "Seal assemblies in subsea rotating control"..</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_patent_count = 2,208</span></code></pre></div>
</div>
<div id="entity-counts" class="section level2">
<h2 class="hasAnchor">
<a href="#entity-counts" class="anchor"></a>Entity counts</h2>
<p>Our last two calls to <code><a href="../../reference/search_pv.html">search_pv()</a></code> gave the same value for <code>total_patent_count</code>, even though we got a lot more data from the second call. This is because the entity counts returned by the API refer to the number of distinct entities across all <em>downloadable pages of output</em>, not just the page that was returned. Downloadable pages of output is an important phrase here, as the API limits us to 100,000 records per query. For example, we got <code>total_patent_count = 100,000</code> when we searched for patents published on or after 2007, even though there are way more than 100,000 such patents. See the FAQs below for details on how to overcome the 100,000 record restriction.</p>
</div>
<div id="endpoints-for-7-entities" class="section level2">
<h2 class="hasAnchor">
<a href="#endpoints-for-7-entities" class="anchor"></a>7 endpoints for 7 entities</h2>
<p>We can get similar data from the 7 endpoints. For example, the following two calls differ only in the endpoint that is chosen:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">query</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventor_last_name <span class="op">=</span> <span class="st">"chambers"</span><span class="op">)</span>
<span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"patent_number"</span>, <span class="st">"inventor_last_name"</span>, <span class="st">"assignee_organization"</span><span class="op">)</span>

<span class="co"># Here we are using the patents endpoint:</span>
<span class="fu"><a href="../../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">query</span>, endpoint <span class="op">=</span> <span class="st">"patents"</span>, fields <span class="op">=</span> <span class="va">fields</span><span class="op">)</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 25 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ patent_number: chr [1:25] "10000988" ...</span>
<span class="co">#&gt;   ..$ inventors    :List of 25</span>
<span class="co">#&gt;   ..$ assignees    :List of 25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_patent_count = 2,208</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># While here we are using the assignees endpoint:</span>
<span class="fu"><a href="../../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">query</span>, endpoint <span class="op">=</span> <span class="st">"assignees"</span>, fields <span class="op">=</span> <span class="va">fields</span><span class="op">)</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on an assignee level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ assignees:'data.frame':   25 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ assignee_organization: chr [1:25] "XEROX CORPORATION" ...</span>
<span class="co">#&gt;   ..$ patents              :List of 25</span>
<span class="co">#&gt;   ..$ inventors            :List of 25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_assignee_count = 531</span></code></pre></div>
<p>Your choice of endpoint determines two things:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Which entity your query is applied to.</strong> The first call shown above used the patents endpoint, so the API searched for patents that have at least one inventor listed on them with the last name “chambers.” The second call used the assignees endpoint, so the API searched for all assignees that have been <em>assigned to at least one patent</em> which has an inventor listed on it with the last name “chambers.”</p></li>
<li><p><strong>The structure of the data frame that is returned.</strong> The first call returned a data frame on the patent level, meaning that each row corresponded to a different patent. Fields that were not on the patent level (e.g., <code>inventor_last_name</code>) were returned in list columns that are named after the entity associated with the field (e.g., the <code>inventors</code> entity).<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> Meanwhile, the second call gave us a data frame on the assignee level (one row for each assignee) because it used the assignees endpoint.</p></li>
</ol>
<p>Most of the time you will want to use the patents endpoint. Note that you can still effectively filter on fields that are not at the patent-level when using the patents endpoint (e.g., you can filter on assignee name or CPC category). This is because patents are relatively low-level entities. For higher level entities like assignees, if you filter on a field that is not at the assignee-level (e.g., inventor name), the API will return data on any assignee that has at least one inventor whose name matches your search, which is probably not what you want.</p>
</div>
<div id="casting-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#casting-fields" class="anchor"></a>Casting fields</h2>
<p>The API always returns the data fields as strings, even if they would be better stored using a different data type (e.g., numeric). You can cast all fields to their preferred R types using <code><a href="../../reference/cast_pv_data.html">cast_pv_data()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/search_pv.html">search_pv</a></span><span class="op">(</span>
  query <span class="op">=</span> <span class="st">"{\"patent_number\":\"5116621\"}"</span>, 
  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"patent_date"</span>, <span class="st">"patent_title"</span>, <span class="st">"patent_year"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># Right now all of the fields are stored as character vectors:</span>
<span class="va">res</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; #### A list with a single data frame on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 1 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ patent_date : chr "1992-05-26"</span>
<span class="co">#&gt;   ..$ patent_title: chr "Anti-inflammatory analgesic patch"</span>
<span class="co">#&gt;   ..$ patent_year : chr "1992"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_patent_count = 1</span>

<span class="co"># Use more appropriate data types:</span>
<span class="fu"><a href="../../reference/cast_pv_data.html">cast_pv_data</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>
<span class="co">#&gt; #### A list with a single data frame on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 1 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ patent_date : Date[1:1], format: "1992-05-26"</span>
<span class="co">#&gt;   ..$ patent_title: chr "Anti-inflammatory analgesic patch"</span>
<span class="co">#&gt;   ..$ patent_year : int 1992</span></code></pre></div>
</div>
<div id="faqs" class="section level2">
<h2 class="hasAnchor">
<a href="#faqs" class="anchor"></a>FAQs</h2>
<div id="im-sure-my-query-is-well-formatted-and-correct-but-i-keep-getting-an-error--whats-the-deal" class="section level4">
<h4 class="hasAnchor">
<a href="#im-sure-my-query-is-well-formatted-and-correct-but-i-keep-getting-an-error--whats-the-deal" class="anchor"></a>I’m sure my query is well formatted and correct but I keep getting an error. What’s the deal?</h4>
<p>The API query syntax guidelines do not cover all of the API’s behavior. Specifically, there are several things that you cannot do which are not documented on the API’s webpage. The <a href="https://docs.ropensci.org/patentsview/articles/writing-queries.html">writing queries vignette</a> has more details on this.</p>
</div>
<div id="does-the-api-have-any-rate-limitingthrottling-controls" class="section level4">
<h4 class="hasAnchor">
<a href="#does-the-api-have-any-rate-limitingthrottling-controls" class="anchor"></a>Does the API have any rate limiting/throttling controls?</h4>
<p>Not at the moment.</p>
</div>
<div id="how-do-i-download-more-than-100000-records" class="section level4">
<h4 class="hasAnchor">
<a href="#how-do-i-download-more-than-100000-records" class="anchor"></a>How do I download more than 100,000 records?</h4>
<p>Your best bet is to split your query into pieces based on dates, then concatenate the results together. For example, the below query would return more than 100,000 records for the patents endpoint:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span><span class="fu">text_any</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="st">'tool animal'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To download all of the records associated with this query, we could split it into two pieces and make two calls to <code><a href="../../reference/search_pv.html">search_pv()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">query_1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span>
  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">and</a></span><span class="op">(</span>
    <span class="fu">text_any</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="st">'tool animal'</span><span class="op">)</span>,
    <span class="fu">lte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2010-01-01"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">query_1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span>
  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">and</a></span><span class="op">(</span>
    <span class="fu">text_any</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="st">'tool animal'</span><span class="op">)</span>,
    <span class="fu">gt</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2010-01-01"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="how-do-i-access-the-data-frames-inside-the-list-columns-returned-by-search_pv" class="section level4">
<h4 class="hasAnchor">
<a href="#how-do-i-access-the-data-frames-inside-the-list-columns-returned-by-search_pv" class="anchor"></a>How do I access the data frames inside the list columns returned by <code>search_pv()</code>?</h4>
<p>Let’s consider the following data, in which assignees are the primary entity while applications and “government interest statements” are the secondary entities (also referred to as subentities):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create field list</span>
<span class="va">asgn_flds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"assignee_id"</span>, <span class="st">"assignee_organization"</span><span class="op">)</span>
<span class="va">subent_flds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/get_fields.html">get_fields</a></span><span class="op">(</span><span class="st">"assignees"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"applications"</span>, <span class="st">"gov_interests"</span><span class="op">)</span><span class="op">)</span>
<span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">asgn_flds</span>, <span class="va">subent_flds</span><span class="op">)</span>

<span class="co"># Pull data</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/search_pv.html">search_pv</a></span><span class="op">(</span>
  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">contains</span><span class="op">(</span>inventor_last_name <span class="op">=</span> <span class="st">"smith"</span><span class="op">)</span>, 
  endpoint <span class="op">=</span> <span class="st">"assignees"</span>, 
  fields <span class="op">=</span> <span class="va">fields</span>
<span class="op">)</span>
<span class="va">res</span><span class="op">$</span><span class="va">data</span>
<span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on an assignee level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ assignees:'data.frame':   25 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ assignee_id          : chr [1:25] "e9449f65-8659-4611-a16d-18f65af5b3b6"..</span>
<span class="co">#&gt;   ..$ assignee_organization: chr [1:25] "U.S. Philips Corporation" ...</span>
<span class="co">#&gt;   ..$ applications         :List of 25</span>
<span class="co">#&gt;   ..$ gov_interests        :List of 25</span></code></pre></div>
<p><code>res$data</code> has vector columns for those fields that belong to the primary entity (e.g., <code>res$data$assignees$assignee_id</code>) and list columns for those fields that belong to any secondary entity (e.g., <code>res$data$assignees$applications</code>). You have two good ways to pull out the data frames that are nested inside these list columns:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Use tidyr::unnest.</strong> (This is probably the easier choice of the two).</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="co"># Get assignee/application data:</span>
<span class="va">res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">assignees</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">applications</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 8</span>
<span class="co">#&gt;   assignee_id   assignee_organi… app_country app_date app_number app_type app_id</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;            &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt; </span>
<span class="co">#&gt; 1 e9449f65-865… U.S. Philips Co… US          1974-01… 05431439   05       05/43…</span>
<span class="co">#&gt; 2 e9449f65-865… U.S. Philips Co… US          1975-07… 05600148   05       05/60…</span>
<span class="co">#&gt; 3 e9449f65-865… U.S. Philips Co… US          1976-01… 05648308   05       05/64…</span>
<span class="co">#&gt; 4 e9449f65-865… U.S. Philips Co… US          1975-09… 05618031   05       05/61…</span>
<span class="co">#&gt; 5 e9449f65-865… U.S. Philips Co… US          1979-02… 06013951   06       06/01…</span>
<span class="co">#&gt; 6 e9449f65-865… U.S. Philips Co… US          1979-01… 06002418   06       06/00…</span>
<span class="co">#&gt; # … with 1 more variable: gov_interests &lt;list&gt;</span>

<span class="co"># Get assignee/gov_interest data:</span>
<span class="va">res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">assignees</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">gov_interests</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 10</span>
<span class="co">#&gt;   assignee_id   assignee_organizati… applications govint_contract… govint_org_id</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;                &lt;list&gt;       &lt;chr&gt;            &lt;chr&gt;        </span>
<span class="co">#&gt; 1 e9449f65-865… U.S. Philips Corpor… &lt;df [19 × 5… &lt;NA&gt;             &lt;NA&gt;         </span>
<span class="co">#&gt; 2 bbbe8bb0-7e4… XEROX CORPORATION    &lt;df [510 × … &lt;NA&gt;             &lt;NA&gt;         </span>
<span class="co">#&gt; 3 bbbe8bb0-7e4… XEROX CORPORATION    &lt;df [510 × … ECD-8721551      31           </span>
<span class="co">#&gt; 4 bbbe8bb0-7e4… XEROX CORPORATION    &lt;df [510 × … 70NANBOH3033     44           </span>
<span class="co">#&gt; 5 bbbe8bb0-7e4… XEROX CORPORATION    &lt;df [510 × … 70NANBOH3033     44           </span>
<span class="co">#&gt; 6 66fc4d3d-4a3… Commonwealth Scient… &lt;df [1 × 5]&gt; &lt;NA&gt;             &lt;NA&gt;         </span>
<span class="co">#&gt; # … with 5 more variables: govint_org_level_one &lt;chr&gt;,</span>
<span class="co">#&gt; #   govint_org_level_two &lt;chr&gt;, govint_org_level_three &lt;lgl&gt;,</span>
<span class="co">#&gt; #   govint_org_name &lt;chr&gt;, govint_raw_statement &lt;chr&gt;</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Use patentsview::unnest_pv_data.</strong> <code><a href="../../reference/unnest_pv_data.html">unnest_pv_data()</a></code> creates a series of data frames (one for each entity level) that are like tables in a relational database. You provide it with the data returned by <code><a href="../../reference/search_pv.html">search_pv()</a></code> and a field that can act as a unique identifier for the primary entities:</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/unnest_pv_data.html">unnest_pv_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">data</span>, pk <span class="op">=</span> <span class="st">"assignee_id"</span><span class="op">)</span>
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ applications :'data.frame':   1951 obs. of  6 variables:</span>
<span class="co">#&gt;   ..$ assignee_id: chr [1:1951] "e9449f65-8659-4611-a16d-18f65af5b3b6" ...</span>
<span class="co">#&gt;   ..$ app_country: chr [1:1951] "US" ...</span>
<span class="co">#&gt;   ..$ app_date   : chr [1:1951] "1974-01-07" ...</span>
<span class="co">#&gt;   ..$ app_number : chr [1:1951] "05431439" ...</span>
<span class="co">#&gt;   ..$ app_type   : chr [1:1951] "05" ...</span>
<span class="co">#&gt;   ..$ app_id     : chr [1:1951] "05/431439" ...</span>
<span class="co">#&gt;  $ gov_interests:'data.frame':   91 obs. of  8 variables:</span>
<span class="co">#&gt;   ..$ assignee_id                 : chr [1:91] "e9449f65-8659-4611-a16d-18f65"..</span>
<span class="co">#&gt;   ..$ govint_contract_award_number: chr [1:91] NA ...</span>
<span class="co">#&gt;   ..$ govint_org_id               : chr [1:91] NA ...</span>
<span class="co">#&gt;   ..$ govint_org_level_one        : chr [1:91] NA ...</span>
<span class="co">#&gt;   ..$ govint_org_level_two        : chr [1:91] NA ...</span>
<span class="co">#&gt;   ..$ govint_org_level_three      : logi [1:91] NA ...</span>
<span class="co">#&gt;   ..$ govint_org_name             : chr [1:91] NA ...</span>
<span class="co">#&gt;   ..$ govint_raw_statement        : chr [1:91] NA ...</span>
<span class="co">#&gt;  $ assignees    :'data.frame':   25 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ assignee_id          : chr [1:25] "e9449f65-8659-4611-a16d-18f65af5b3b6"..</span>
<span class="co">#&gt;   ..$ assignee_organization: chr [1:25] "U.S. Philips Corporation" ...</span></code></pre></div>
<p>Now we are left with a series of flat data frames instead of having a single data frame with other data frames nested inside of it. These flat data frames can be joined together as needed via the primary key (<code>assignee_id</code>).</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>You can use <code><a href="../../reference/get_endpoints.html">get_endpoints()</a></code> to list the endpoint names as the API expects them to appear (e.g., <code>assignees</code>, <code>cpc_subsections</code>, <code>inventors</code>, <code>locations</code>, <code>nber_subcategories</code>, <code>patents</code>, and <code>uspc_mainclasses</code>).<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>This webpage includes some details that are not relevant to the <code>query</code> argument in <code>search_pv</code>, such as the field list and sort parameter.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>You can unnest the data frames that are stored in the list columns using <code><a href="../../reference/unnest_pv_data.html">unnest_pv_data()</a></code>. See the FAQs for details.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christopher Baker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
