<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="patentsview">
<title>Getting started • patentsview</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started">
<meta property="og:description" content="patentsview">
<meta property="og:image" content="https://mustberuss.github.io/patentsview/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">patentsview</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--api-changes">
    <span class="fa fa-flag"></span>
     
    API Changes
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--api-changes">
    <a class="dropdown-item" href="../articles/api-changes.html">
      <span class="fa fa-exclamation"></span>
       
      2024 API Changes
    </a>
    <a class="dropdown-item" href="../articles/converting-an-existing-script.html">
      <span class="fa fa-sync"></span>
       
      Converting an Existing Script
    </a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/getting-started.html">
    <span class="fa fa-play"></span>
     
    Getting started
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/writing-queries.html">
    <span class="fa fa-pencil"></span>
     
    Writing queries
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--applications">
    <span class="fa fa-bar-chart"></span>
     
    Applications
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--applications">
    <a class="dropdown-item" href="../articles/examples.html">
      <span class="fa fa-code"></span>
       
      Examples
    </a>
    <a class="dropdown-item" href="../articles/top-assignees.html">
      <span class="fa fa-university"></span>
       
      Top assignees
    </a>
    <a class="dropdown-item" href="../articles/citation-networks.html">
      <span class="fa fa-long-arrow-left"></span>
       
      Citation networks
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/patentsview/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/HEAD/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="important-api-change">Important API Change<a class="anchor" aria-label="anchor" href="#important-api-change"></a>
</h2>
<p>The new version of the API requires an API key, or all of your
requests will be rejected. Request an API key using this link: <a href="https://patentsview.org/apis/keyrequest" class="external-link uri">https://patentsview.org/apis/keyrequest</a> Once you have
one, you’ll need to set an environmental variable PATENTSVIEW_API_KEY to
the value of your API key for the R package to use.</p>
</div>
<div class="section level2">
<h2 id="a-basic-example">A basic example<a class="anchor" aria-label="anchor" href="#a-basic-example"></a>
</h2>
<p>Let’s start with a basic example of how to use the package’s primary
function, <code><a href="../reference/search_pv.html">search_pv()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mustberuss.github.io/patentsview/index.html">patentsview</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="st">'{"_gte":{"patent_date":"2007-01-01"}}'</span>,</span>
<span>  endpoint <span class="op">=</span> <span class="st">"patent"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id   : chr [1:1000] "10000000" ...</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr [1:1000] "Coherent LADAR using intra-pixel quadrature"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date : chr [1:1000] "2018-06-19" ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 5,362,291</span></span></code></pre></div>
<p>This call to <code><a href="../reference/search_pv.html">search_pv()</a></code> sends our query to the patents
endpoint (the default). The API has 18 different endpoints,
corresponding to 18 different entity types (application_citation,
assignee, cpc_group, cpc_subgroup, cpc_subsection, inventor, location,
nber_category, nber_subcategory, patent, patent_citation, uspc_mainclass
and uspc_subclass).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;You can use &lt;code&gt;&lt;a href="../reference/get_endpoints.html"&gt;get_endpoints()&lt;/a&gt;&lt;/code&gt; to list the
endpoint names the R package uses (e.g., &lt;code&gt;assignees&lt;/code&gt;,
&lt;code&gt;cpc_subsections&lt;/code&gt;, &lt;code&gt;inventors&lt;/code&gt;,
&lt;code&gt;locations&lt;/code&gt;, &lt;code&gt;nber_subcategories&lt;/code&gt;,
&lt;code&gt;patents&lt;/code&gt;, and &lt;code&gt;uspc_mainclasses&lt;/code&gt;). An API change
made the actual endpoints singluar, though the returned entities are
still plural (which is why the R package still uses the plural names).&lt;/p&gt;'><sup>1</sup></a> Your choice of endpoint determines which
entity your query is applied to, as well as the structure of the data
that is returned (more on this in the “18 endpoints for 18 entities
section”). For now, let’s turn our attention to the <code>query</code>
parameter.</p>
</div>
<div class="section level2">
<h2 id="writing-queries">Writing queries<a class="anchor" aria-label="anchor" href="#writing-queries"></a>
</h2>
<p>The PatentsView query syntax is documented on their <a href="https://patentsview.org/apis/api-query-language#query_string_format" class="external-link">query
language page</a> note also the change to the Options parameter for the
new version of the API mentioned on that page.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This webpage includes some details that are not relevant
to the &lt;code&gt;query&lt;/code&gt; argument in &lt;code&gt;search_pv&lt;/code&gt;, such as
the field list and sort parameter.&lt;/p&gt;"><sup>2</sup></a> However, it can be
difficult to get your query right if you’re writing it by hand (i.e.,
just writing the query in a string like
<code>'{"_gte":{"patent_date":"2007-01-01"}}'</code>, as we did in the
example shown above). The <code>patentsview</code> package comes with a
simple domain specific language (DSL) to make writing queries a breeze.
I recommend using the functions in this DSL for all but the most basic
queries, especially if you’re encountering errors and don’t understand
why. To get a feel for how it works, let’s rewrite the query shown above
using one of the functions in the DSL, <code>qry_funs$gte()</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qry_funs</span><span class="op">$</span><span class="fu">gte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2007-01-01"</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_gte":{"patent_date":"2007-01-01"}}</span></span></code></pre></div>
<p>More complex queries are also possible:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">and</a></span><span class="op">(</span></span>
<span>    <span class="fu">gte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2007-01-01"</span><span class="op">)</span>,</span>
<span>    <span class="fu">text_phrase</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"computer program"</span>, <span class="st">"dog leash"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_and":[{"_gte":{"patent_date":"2007-01-01"}},{"_or":[{"_text_phrase":{"patent_abstract":"computer program"}},{"_text_phrase":{"patent_abstract":"dog leash"}}]}]}</span></span></code></pre></div>
<p>Check out the <a href="https://docs.ropensci.org/patentsview/articles/writing-queries.html" class="external-link">writing
queries vignette</a> for more details on using the DSL.</p>
</div>
<div class="section level2">
<h2 id="fields">Fields<a class="anchor" aria-label="anchor" href="#fields"></a>
</h2>
<p>Each endpoint has a different set of <em>queryable</em> and
<em>retrievable</em> fields. Queryable fields are those that you can
include in your query (e.g., <code>patent_date</code> shown in the first
example). Retrievable fields are those that you can get data on (i.e.,
fields returned by <code><a href="../reference/search_pv.html">search_pv()</a></code>). The new version of the API
allows all retrievable fields to be queried. In the first example, we
didn’t specify which fields we wanted to retrieve so we were given the
default set. You can specify which fields you want using the
<code>fields</code> argument:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># search_pv defaults the endpoint parameter to "patents" if not specified</span></span>
<span><span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="st">'{"_gte":{"patent_date":"2007-01-01"}}'</span>,</span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="st">"patent_title"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id   : chr [1:1000] "10000000" ...</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr [1:1000] "Coherent LADAR using intra-pixel quadrature"..</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 5,362,291</span></span></code></pre></div>
<p>To list all of the retrievable fields for a given endpoint, use
<code><a href="../reference/get_fields.html">get_fields()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">retrvble_flds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patent"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">retrvble_flds</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "applicants.applicant_designation"  "applicants.applicant_name_first"  </span></span>
<span><span class="co">#&gt; [3] "applicants.applicant_name_last"    "applicants.applicant_organization"</span></span>
<span><span class="co">#&gt; [5] "applicants.applicant_sequence"     "applicants.applicant_type"</span></span></code></pre></div>
<p>See the <a href="https://search.patentsview.org/swagger-ui/" class="external-link">Swagger
UI page</a> for the API, the fields returned are listed for each
endpoint in the 200 Response body sections.</p>
<p>You can also visit an endpoint’s online documentation page to see a
list of its retrievable fields (e.g., see the <a href="https://patentsview.org/apis/api-endpoints/inventorsbeta#field_list" class="external-link">inventor
field list table</a>). In earlier versions of the API not all fields
were queryable as they are now. The field tables for all of the
endpoints can be found in the <code>fieldsdf</code> data frame, which
you can load using <code>data("fieldsdf")</code> or
<code>View(patentsview::fieldsdf)</code>.</p>
<p><strong>An important note: By default, PatentsView uses disambiguted
versions of assignees, inventors, and locations, instead of raw
data.</strong> For example, let’s say you search for all inventors whose
first name is “john.” The PatentsView API is going to return all of the
inventors who have a preferred first name (as per the disambiguation
results) of john, which may not necessarily be their raw first name. You
could be getting back inventors whose first name appears on the patent
as, say, “jonathan,” “johnn,” or even “john jay.” You can search on the
raw inventor names instead of the preferred names by using the fields
starting with “raw” in your query (e.g.,
<code>rawinventor_first_name</code>). The assignee and location raw data
fields are not currently being offered by the API. To see the methods
behind the disambiguation process, see the <a href="https://patentsview.org/disambiguation" class="external-link">PatentsView Inventor
Disambiguation Technical Workshop website</a>.</p>
</div>
<div class="section level2">
<h2 id="paginated-responses">Paginated responses<a class="anchor" aria-label="anchor" href="#paginated-responses"></a>
</h2>
<p>By default, <code><a href="../reference/search_pv.html">search_pv()</a></code> returns 1,000 records per page
and only gives you the first page of results. I suggest starting with
something smaler, like the <code>per_page</code> = 150 below, while
you’re figuring out the details of your request, such as the query you
want to use and the fields you want returned. Once you have those items
finalized, you can use the <code>per_page</code> argument to download up
to 1,000 records per page.</p>
<p>You can download all pages of output in one call by setting
<code>all_pages = TRUE</code>. This will set <code>per_page</code> equal
to 1,000 and loop over all pages of output (downloading up to 10 pages,
or 10,000 records total):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Chambers"</span><span class="op">)</span>,</span>
<span>  all_pages <span class="op">=</span> <span class="cn">TRUE</span>, per_page <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 2459 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   ..$ patent_id: chr [1:2459] "10000988" ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 2,459</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="entity-counts">Entity counts<a class="anchor" aria-label="anchor" href="#entity-counts"></a>
</h2>
<p>Our last two calls to <code><a href="../reference/search_pv.html">search_pv()</a></code> gave the same value
for <code>total_hits</code>, even though we got a lot more data from the
second call. This is because the entity counts returned by the API refer
to the number of distinct entities across all <em>downloadable pages of
output</em>, not just the page that was returned. Downloadable pages of
output is an important phrase here, as the API limits us to 10,000
records per query. For example, we got
<code>total_patent_count = 10,000</code> when we searched for patents
published on or after 2007, even though there are way more than 10,000
such patents. See the FAQs below for details on how to overcome the
10,000 record restriction.</p>
</div>
<div class="section level2">
<h2 id="endpoints-for-18-entities">18 endpoints for 18 entities<a class="anchor" aria-label="anchor" href="#endpoints-for-18-entities"></a>
</h2>
<p>With the recent API change, the patents endpoint supplies the basic
patent data and the other endponts return more specific data for those
patents.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Chambers"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Here we'll request patent_id and the inventor fields from the patents endpoint</span></span>
<span><span class="va">inv_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patent"</span>, groups <span class="op">=</span><span class="st">"inventors"</span><span class="op">)</span></span>
<span><span class="va">inv_fields</span></span>
<span><span class="co">#&gt; [1] "inventors.inventor_city"       "inventors.inventor_country"   </span></span>
<span><span class="co">#&gt; [3] "inventors.inventor_id"         "inventors.inventor_name_first"</span></span>
<span><span class="co">#&gt; [5] "inventors.inventor_name_last"  "inventors.inventor_sequence"  </span></span>
<span><span class="co">#&gt; [7] "inventors.inventor_state"</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">inv_fields</span>, <span class="st">"patent_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">query</span>, endpoint <span class="op">=</span> <span class="st">"patent"</span>, fields <span class="op">=</span> <span class="va">fields</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id: chr [1:1000] "10000988" ...</span></span>
<span><span class="co">#&gt;   ..$ inventors:List of 1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 2,459</span></span>
<span></span>
<span><span class="co"># Here's the first inventors</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patents</span><span class="op">$</span><span class="va">inventors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                                               inventor</span></span>
<span><span class="co">#&gt; 1   https://search.patentsview.org/api/v1/inventor/fl:si_ln:harrall-1/</span></span>
<span><span class="co">#&gt; 2   https://search.patentsview.org/api/v1/inventor/fl:da_ln:wagoner-1/</span></span>
<span><span class="co">#&gt; 3   https://search.patentsview.org/api/v1/inventor/fl:th_ln:bailey-10/</span></span>
<span><span class="co">#&gt; 4     https://search.patentsview.org/api/v1/inventor/fl:an_ln:barry-8/</span></span>
<span><span class="co">#&gt; 5 https://search.patentsview.org/api/v1/inventor/fl:ja_ln:chambers-11/</span></span>
<span><span class="co">#&gt;   inventor_name_first inventor_name_last inventor_city inventor_state</span></span>
<span><span class="co">#&gt; 1            Simon J.            Harrall       Houston             TX</span></span>
<span><span class="co">#&gt; 2            Danny W.            Wagoner       Cypress             TX</span></span>
<span><span class="co">#&gt; 3           Thomas F.             Bailey       Houston             TX</span></span>
<span><span class="co">#&gt; 4        Andrew A. W.              Barry Missouri City             TX</span></span>
<span><span class="co">#&gt; 5            James W.           Chambers       Hackett             AR</span></span>
<span><span class="co">#&gt;   inventor_country inventor_sequence</span></span>
<span><span class="co">#&gt; 1               US                 4</span></span>
<span><span class="co">#&gt; 2               US                 1</span></span>
<span><span class="co">#&gt; 3               US                 0</span></span>
<span><span class="co">#&gt; 4               US                 3</span></span>
<span><span class="co">#&gt; 5               US                 2</span></span>
<span></span>
<span><span class="co"># Now we will see what the inventors endpoint returns for a similar query.  We use get_fields() to get all the available for the inventors endpoint.</span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventor_name_last <span class="op">=</span> <span class="st">"Chambers"</span><span class="op">)</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"inventor"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">query</span>, endpoint <span class="op">=</span> <span class="st">"inventor"</span>, fields <span class="op">=</span> <span class="va">fields</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on inventors level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ inventors:'data.frame':   434 obs. of  16 variables:</span></span>
<span><span class="co">#&gt;   ..$ inventor_id                 : chr [1:434] "1vk0dcohf8r1vofo538cfxl2g" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_name_first         : chr [1:434] "Gilbert V." ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_name_last          : chr [1:434] "Chambers" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_gender_code        : chr [1:434] "M" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_city     : chr [1:434] "Baytown" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_state    : chr [1:434] "TX" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_country  : chr [1:434] "US" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_latitude : num [1:434] 29.7 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_longitude: num [1:434] -95 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_location : chr [1:434] "https://search.patentsview.o"..</span></span>
<span><span class="co">#&gt;   ..$ inventor_num_patents        : int [1:434] 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_num_assignees      : int [1:434] 1 2 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_first_seen_date    : chr [1:434] "1995-10-17" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_last_seen_date     : chr [1:434] "1995-10-17" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_years_active       : num [1:434] 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_years              :List of 434</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 434</span></span></code></pre></div>
<p>Your choice of endpoint determines two things:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Which entity your query is applied to.</strong> The first
call shown above used the patents endpoint, so the API searched for
patents that have at least one inventor listed on them with the last
name “chambers.” The second call used the inventors endpoint to show
what it returns for a similar query.</p></li>
<li><p><strong>The structure of the data frame that is
returned.</strong> The first call returned a data frame on the patent
level, meaning that each row corresponded to a different patent. Fields
that were not on the patent level (e.g.,
<code>inventors.inventor_name_last</code>) were returned in list columns
that are named after the entity associated with the field (e.g., the
<code>inventors</code> entity).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;You can unnest the data frames that are stored in the
list columns using &lt;code&gt;&lt;a href="../reference/unnest_pv_data.html"&gt;unnest_pv_data()&lt;/a&gt;&lt;/code&gt;. See the FAQs for
details.&lt;/p&gt;'><sup>3</sup></a> Meanwhile, the second call gave us a data
frame on the inventor level (one row for each inventor) because it used
the inventors endpoint.</p></li>
</ol>
<p>Most of the time you will want to use the patents endpoint. Note that
you can still effectively filter on fields that are not at the
patent-level when using the patents endpoint (e.g., you can filter on
assignee name or CPC category). This is because patents are relatively
low-level entities. For higher level entities like assignees, if you
filter on a field that is not at the assignee-level (e.g., inventor
name), the API will return data on any assignee that has at least one
inventor whose name matches your search, which is probably not what you
want.</p>
</div>
<div class="section level2">
<h2 id="casting-fields">Casting fields<a class="anchor" aria-label="anchor" href="#casting-fields"></a>
</h2>
<p>The API now returns most data fields as an appropriate data type
(e.g., numeric). There is a small number of fields that are returned as
strings where integers woudl be more appropriate. You can cast all
fields to their preferred R types using <code><a href="../reference/cast_pv_data.html">cast_pv_data()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="st">"{\"patent_id\":\"5116621\"}"</span>, </span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_date"</span>, <span class="st">"patent_title"</span>, <span class="st">"patent_year"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr "Anti-inflammatory analgesic patch"</span></span>
<span><span class="co">#&gt;   ..$ patent_date : chr "1992-05-26"</span></span>
<span><span class="co">#&gt;   ..$ patent_year : int 1992</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 1</span></span>
<span><span class="co"># [&lt;span style="color: red;"&gt;trouble here&lt;/span&gt;]</span></span>
<span><span class="co"># Use more appropriate data types:</span></span>
<span><span class="fu"><a href="../reference/cast_pv_data.html">cast_pv_data</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr "Anti-inflammatory analgesic patch"</span></span>
<span><span class="co">#&gt;   ..$ patent_date : Date[1:1], format: "1992-05-26"</span></span>
<span><span class="co">#&gt;   ..$ patent_year : int 1992</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="faqs">FAQs<a class="anchor" aria-label="anchor" href="#faqs"></a>
</h2>
<div class="section level4">
<h4 id="im-sure-my-query-is-well-formatted-and-correct-but-i-keep-getting-an-error--whats-the-deal">I’m sure my query is well formatted and correct but I keep getting
an error. What’s the deal?<a class="anchor" aria-label="anchor" href="#im-sure-my-query-is-well-formatted-and-correct-but-i-keep-getting-an-error--whats-the-deal"></a>
</h4>
<p>The API query syntax guidelines do not cover all of the API’s
behavior. Specifically, there are several things that you cannot do
which are not documented on the API’s webpage. The <a href="https://docs.ropensci.org/patentsview/articles/writing-queries.html" class="external-link">writing
queries vignette</a> has more details on this. You can also try the
string version of your query in the API’s <a href="https://search.patentsview.org/swagger-ui/" class="external-link">Swagger UI page</a>.
Its error messages can sometimes help determine the problem.</p>
</div>
<div class="section level4">
<h4 id="does-the-api-have-any-rate-limitingthrottling-controls">Does the API have any rate limiting/throttling controls?<a class="anchor" aria-label="anchor" href="#does-the-api-have-any-rate-limitingthrottling-controls"></a>
</h4>
<p>Yes, the API currently allows 45 calls per minute for each API key.
If this limit is exceeded the API will return an http status of 429 with
a response header Retry-After set to the number of seconds to wait until
making subsequent requests. The R package should handle this for you.
You will need to <a href="https://patentsview.org/apis/keyrequest" class="external-link">request an API key</a>
and set the environmental variable PATENTSVIEW_API_KEY to the value of
your key.</p>
</div>
<div class="section level4">
<h4 id="how-do-i-download-more-than-10000-records">How do I download more than 10,000 records?<a class="anchor" aria-label="anchor" href="#how-do-i-download-more-than-10000-records"></a>
</h4>
<p>Your best bet is to split your query into pieces based on dates, then
concatenate the results together. There is more on this in the <a href="converting-an-existing-script.html#reduced-query-size-1">Converting
an existing script vignette</a></p>
<p>For example, the below query would return more than 10,000 records
for the patents endpoint:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span>patent_title <span class="op">=</span> <span class="st">'game'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To download all of the records associated with this query, we could
split it into three pieces and make three calls to
<code><a href="../reference/search_pv.html">search_pv()</a></code>, each with all_pages = TRUE:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query_1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">and</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span>patent_title <span class="op">=</span> <span class="st">'game'</span><span class="op">)</span>,</span>
<span>    <span class="fu">lte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2010-05-17"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">query_1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">and</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span>patent_title <span class="op">=</span> <span class="st">'game'</span><span class="op">)</span>,</span>
<span>    <span class="va">qry_funs</span><span class="op">$</span><span class="fu">in_range</span><span class="op">(</span>patent_date<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2010-05-18"</span>, <span class="st">"2021-05-10"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">query_1c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">and</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span>patent_title <span class="op">=</span> <span class="st">'game'</span><span class="op">)</span>,</span>
<span>    <span class="fu">gte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2021-05-11"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that at the time this was written, the original query returned
20,521 rows. At some point in the future query_1c could return more than
10,000 rows.</p>
</div>
<div class="section level4">
<h4 id="how-do-i-access-the-data-frames-inside-the-list-columns-returned-by-search_pv">How do I access the data frames inside the list columns returned by
<code>search_pv()</code>?<a class="anchor" aria-label="anchor" href="#how-do-i-access-the-data-frames-inside-the-list-columns-returned-by-search_pv"></a>
</h4>
<p>Let’s consider the following data, in which assignees are the primary
entity while applications and “government interest statements” are the
secondary entities (also referred to as subentities): Government
interests fields are no longer present</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create field list -</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span><span class="st">"patent"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pull data</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">text_any</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Smith"</span><span class="op">)</span>, </span>
<span>  endpoint <span class="op">=</span> <span class="st">"patent"</span>, </span>
<span>  fields <span class="op">=</span> <span class="va">fields</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  36 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id                                                   : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_title                                                : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_type                                                 : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date                                                 : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_year                                                 : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_abstract                                             : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_cpc_current_group_average_patent_processing_days     : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_detail_desc_length                                   : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_earliest_application_date                            : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_foreign_documents_cited                          : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_times_cited_by_us_patents                        : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_total_documents_cited                            : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_us_applications_cited                            : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_us_patents_cited                                 : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_processing_days                                      : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_term_extension                                       : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ gov_interest_statement                                      : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_uspc_current_mainclass_average_patent_processing_days: logi [1:10..</span></span>
<span><span class="co">#&gt;   ..$ application                                                 :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ applicants                                                  :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ assignees                                                   :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ attorneys                                                   :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ cpc_at_issue                                                :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ cpc_current                                                 :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ examiners                                                   :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ figures                                                     :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ gov_interest_organizations                                  :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ granted_pregrant_crosswalk                                  :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ inventors                                                   :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ ipcr                                                        :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ us_related_documents                                        :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ us_term_of_grant                                            :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ wipo                                                        :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ foreign_priority                                            :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ pct_data                                                    :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ gov_interest_contract_award_numbers                         :List of 1000</span></span></code></pre></div>
<p><code>res$data</code> has vector columns for those fields that belong
to the primary entity (e.g., <code>res$data$patent_year</code>) and list
columns for those fields that belong to any secondary entity (e.g.,
<code>res$data$assignees$assignee_organization</code>). You have two
good ways to pull out the data frames that are nested inside these list
columns:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Use tidyr::unnest.</strong> (This is probably the easier
choice of the two).</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get assignee data:</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patents</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">assignees</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 44</span></span>
<span><span class="co">#&gt;   patent_id patent_title paten…¹ paten…² paten…³ paten…⁴ paten…⁵ paten…⁶ paten…⁷</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;     &lt;int&gt;   &lt;int&gt; &lt;chr&gt;  </span></span>
<span><span class="co">#&gt; 1 10000036  High kineti… utility 2018-0…    2018 Boron …    1286   11286 2015-0…</span></span>
<span><span class="co">#&gt; 2 10000466  Substituted… utility 2018-0…    2018 The pr…     904  290583 2017-0…</span></span>
<span><span class="co">#&gt; 3 10000693  Methods and… utility 2018-0…    2018 Method…    1229  156395 2014-0…</span></span>
<span><span class="co">#&gt; 4 10000750  Method of i… utility 2018-0…    2018 Disclo…    1221   81511 2015-1…</span></span>
<span><span class="co">#&gt; 5 10000975  Cutting ele… utility 2018-0…    2018 A cutt…    1263    6690 2014-0…</span></span>
<span><span class="co">#&gt; 6 10000976  Cutting ele… utility 2018-0…    2018 A cutt…    1263   15136 2014-0…</span></span>
<span><span class="co">#&gt; # … with 35 more variables: patent_num_foreign_documents_cited &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   patent_num_times_cited_by_us_patents &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   patent_num_total_documents_cited &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   patent_num_us_applications_cited &lt;int&gt;, patent_num_us_patents_cited &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   patent_processing_days &lt;int&gt;, patent_term_extension &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   gov_interest_statement &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   patent_uspc_current_mainclass_average_patent_processing_days &lt;lgl&gt;, …</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Use patentsview::unnest_pv_data.</strong>
<code><a href="../reference/unnest_pv_data.html">unnest_pv_data()</a></code> creates a series of data frames (one for
each entity level) that are like tables in a relational database. You
provide it with the data returned by <code><a href="../reference/search_pv.html">search_pv()</a></code> and a
field that can act as a unique identifier for the primary entities:</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/unnest_pv_data.html">unnest_pv_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">data</span>, pk <span class="op">=</span> <span class="st">"patent_id"</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 19</span></span>
<span><span class="co">#&gt;  $ application                        :'data.frame': 1000 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id       : chr [1:1000] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ application_id  : chr [1:1000] "14/753848" ...</span></span>
<span><span class="co">#&gt;   ..$ application_type: chr [1:1000] "14" ...</span></span>
<span><span class="co">#&gt;   ..$ filing_date     : chr [1:1000] "2015-06-29" ...</span></span>
<span><span class="co">#&gt;   ..$ series_code     : chr [1:1000] "14" ...</span></span>
<span><span class="co">#&gt;   ..$ rule_47_flag    : logi [1:1000] FALSE ...</span></span>
<span><span class="co">#&gt;   ..$ filing_type     : chr [1:1000] "14" ...</span></span>
<span><span class="co">#&gt;  $ applicants                         :'data.frame': 1215 obs. of  8 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id             : chr [1:1215] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ applicant_name_first  : chr [1:1215] NA ...</span></span>
<span><span class="co">#&gt;   ..$ applicant_name_last   : chr [1:1215] NA ...</span></span>
<span><span class="co">#&gt;   ..$ applicant_organization: chr [1:1215] "The United States of America repr"..</span></span>
<span><span class="co">#&gt;   ..$ applicant_sequence    : int [1:1215] 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ applicant_designation : chr [1:1215] "us-only" ...</span></span>
<span><span class="co">#&gt;   ..$ applicant_type        : chr [1:1215] "applicant" ...</span></span>
<span><span class="co">#&gt;   ..$ location_id           : chr [1:1215] "fe1dd7c7-16c7-11ed-9b5f-1234bde3c"..</span></span>
<span><span class="co">#&gt;  $ assignees                          :'data.frame': 975 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id                     : chr [1:975] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee                      : chr [1:975] "https://search.patentsview"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_type                 : chr [1:975] "6" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_individual_name_first: chr [1:975] NA ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_individual_name_last : chr [1:975] NA ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_organization         : chr [1:975] "The United States of Ameri"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_city                 : chr [1:975] "Washington" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_state                : chr [1:975] "DC" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_country              : chr [1:975] "US" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_sequence             : int [1:975] 0 0 ...</span></span>
<span><span class="co">#&gt;  $ attorneys                          :'data.frame': 1131 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id            : chr [1:1131] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ attorney_id          : chr [1:1131] "3f82077f3559b6f685a391bfbcb2202e" ...</span></span>
<span><span class="co">#&gt;   ..$ attorney_sequence    : int [1:1131] 0 1 ...</span></span>
<span><span class="co">#&gt;   ..$ attorney_name_first  : chr [1:1131] "Jennifer L." ...</span></span>
<span><span class="co">#&gt;   ..$ attorney_name_last   : chr [1:1131] "Riley" ...</span></span>
<span><span class="co">#&gt;   ..$ attorney_organization: chr [1:1131] NA ...</span></span>
<span><span class="co">#&gt;  $ cpc_at_issue                       :'data.frame': 7715 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id      : chr [1:7715] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_sequence   : int [1:7715] 1 2 ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_class_id   : chr [1:7715] "B32" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_subclass_id: chr [1:7715] "B32B" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_group_id   : chr [1:7715] "B32B5/26" ...</span></span>
<span><span class="co">#&gt;  $ cpc_current                        :'data.frame': 9497 obs. of  8 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id      : chr [1:9497] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_sequence   : int [1:9497] 0 1 ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_class      : chr [1:9497] "https://search.patentsview.org/api/v1/cp"..</span></span>
<span><span class="co">#&gt;   ..$ cpc_class_id   : chr [1:9497] "B32" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_subclass   : chr [1:9497] "https://search.patentsview.org/api/v1/cp"..</span></span>
<span><span class="co">#&gt;   ..$ cpc_subclass_id: chr [1:9497] "B32B" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_group      : chr [1:9497] "https://search.patentsview.org/api/v1/cp"..</span></span>
<span><span class="co">#&gt;   ..$ cpc_group_id   : chr [1:9497] "B32B5/26" ...</span></span>
<span><span class="co">#&gt;  $ examiners                          :'data.frame': 1227 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id          : chr [1:1227] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ examiner_id        : chr [1:1227] "l5ntkof8nrlpiyj3rcmiiln2g" ...</span></span>
<span><span class="co">#&gt;   ..$ examiner_first_name: chr [1:1227] "Daniel H" ...</span></span>
<span><span class="co">#&gt;   ..$ examiner_last_name : chr [1:1227] "Lee" ...</span></span>
<span><span class="co">#&gt;   ..$ examiner_role      : chr [1:1227] "primary" ...</span></span>
<span><span class="co">#&gt;   ..$ art_group          : chr [1:1227] "1746" ...</span></span>
<span><span class="co">#&gt;  $ figures                            :'data.frame': 968 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id  : chr [1:968] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ num_figures: int [1:968] 19 1 ...</span></span>
<span><span class="co">#&gt;   ..$ num_sheets : int [1:968] 6 1 ...</span></span>
<span><span class="co">#&gt;  $ gov_interest_organizations         :'data.frame': 43 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id     : chr [1:43] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ fedagency_name: chr [1:43] "National Aeronautics and Space Administrati"..</span></span>
<span><span class="co">#&gt;   ..$ level_one     : chr [1:43] "National Aeronautics and Space Administrati"..</span></span>
<span><span class="co">#&gt;   ..$ level_two     : chr [1:43] NA ...</span></span>
<span><span class="co">#&gt;   ..$ level_three   : chr [1:43] NA ...</span></span>
<span><span class="co">#&gt;  $ granted_pregrant_crosswalk         :'data.frame': 1004 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id         : chr [1:1004] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ document_number   : chr [1:1004] "20170190143" ...</span></span>
<span><span class="co">#&gt;   ..$ application_number: chr [1:1004] "14753848" ...</span></span>
<span><span class="co">#&gt;  $ inventors                          :'data.frame': 4153 obs. of  8 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id          : chr [1:4153] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor           : chr [1:4153] "https://search.patentsview.org/api/v"..</span></span>
<span><span class="co">#&gt;   ..$ inventor_name_first: chr [1:4153] "Cheol" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_name_last : chr [1:4153] "Park" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_city      : chr [1:4153] "Yorktown" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_state     : chr [1:4153] "VA" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_country   : chr [1:4153] "US" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_sequence  : int [1:4153] 1 3 ...</span></span>
<span><span class="co">#&gt;  $ ipcr                               :'data.frame': 5383 obs. of  11 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id                     : chr [1:5383] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_sequence                  : int [1:5383] 0 1 ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_action_date               : chr [1:5383] "2018-06-19" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_section                   : chr [1:5383] "B" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_class                     : chr [1:5383] "32" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_subclass                  : chr [1:5383] "B" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_main_group                : chr [1:5383] "5" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_subgroup                  : chr [1:5383] "26" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_symbol_position           : chr [1:5383] "F" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_classification_data_source: chr [1:5383] "H" ...</span></span>
<span><span class="co">#&gt;   ..$ ipc_classification_value      : chr [1:5383] "I" ...</span></span>
<span><span class="co">#&gt;  $ us_related_documents               :'data.frame': 4349 obs. of  9 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id                 : chr [1:4349] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ related_doc_type          : chr [1:4349] "division" ...</span></span>
<span><span class="co">#&gt;   ..$ related_doc_kind          : chr [1:4349] NA ...</span></span>
<span><span class="co">#&gt;   ..$ related_doc_number        : chr [1:4349] "13136216" ...</span></span>
<span><span class="co">#&gt;   ..$ published_country         : chr [1:4349] "US" ...</span></span>
<span><span class="co">#&gt;   ..$ related_doc_published_date: chr [1:4349] "2011-07-26" ...</span></span>
<span><span class="co">#&gt;   ..$ related_doc_status        : chr [1:4349] NA ...</span></span>
<span><span class="co">#&gt;   ..$ related_doc_sequence      : int [1:4349] 0 1 ...</span></span>
<span><span class="co">#&gt;   ..$ wipo_kind                 : chr [1:4349] NA ...</span></span>
<span><span class="co">#&gt;  $ us_term_of_grant                   :'data.frame': 658 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id      : chr [1:658] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ term_grant     : logi [1:658] NA ...</span></span>
<span><span class="co">#&gt;   ..$ term_extension : chr [1:658] "85" ...</span></span>
<span><span class="co">#&gt;   ..$ term_disclaimer: chr [1:658] NA ...</span></span>
<span><span class="co">#&gt;   ..$ disclaimer_date: logi [1:658] NA ...</span></span>
<span><span class="co">#&gt;  $ wipo                               :'data.frame': 1748 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id    : chr [1:1748] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ wipo_field_id: chr [1:1748] "29" ...</span></span>
<span><span class="co">#&gt;   ..$ wipo_sequence: int [1:1748] 0 1 ...</span></span>
<span><span class="co">#&gt;  $ foreign_priority                   :'data.frame': 87 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id              : chr [1:87] "10000975" ...</span></span>
<span><span class="co">#&gt;   ..$ priority_claim_sequence: int [1:87] 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ priority_claim_kind    : chr [1:87] "national" ...</span></span>
<span><span class="co">#&gt;   ..$ foreign_application_id : chr [1:87] "1301647.2" ...</span></span>
<span><span class="co">#&gt;   ..$ filing_date            : chr [1:87] "2013-01-30" ...</span></span>
<span><span class="co">#&gt;   ..$ foreign_country_filed  : chr [1:87] "GB" ...</span></span>
<span><span class="co">#&gt;  $ pct_data                           :'data.frame': 218 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id           : chr [1:218] "10000975" ...</span></span>
<span><span class="co">#&gt;   ..$ published_filed_date: chr [1:218] "2014-01-28" ...</span></span>
<span><span class="co">#&gt;   ..$ pct_102_date        : logi [1:218] NA ...</span></span>
<span><span class="co">#&gt;   ..$ pct_371_date        : chr [1:218] "2015-07-28" ...</span></span>
<span><span class="co">#&gt;   ..$ application_kind    : chr [1:218] "00" ...</span></span>
<span><span class="co">#&gt;   ..$ pct_doc_number      : chr [1:218] "PCT/GB2014/050210" ...</span></span>
<span><span class="co">#&gt;   ..$ pct_doc_type        : chr [1:218] "pct_application" ...</span></span>
<span><span class="co">#&gt;  $ gov_interest_contract_award_numbers:'data.frame': 36 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id   : chr [1:36] "10004797" ...</span></span>
<span><span class="co">#&gt;   ..$ award_number: chr [1:36] "2007-33610-18035" ...</span></span>
<span><span class="co">#&gt;  $ patents                            :'data.frame': 1000 obs. of  18 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id                                                   : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_title                                                : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_type                                                 : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date                                                 : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_year                                                 : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_abstract                                             : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_cpc_current_group_average_patent_processing_days     : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_detail_desc_length                                   : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_earliest_application_date                            : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_foreign_documents_cited                          : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_times_cited_by_us_patents                        : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_total_documents_cited                            : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_us_applications_cited                            : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_us_patents_cited                                 : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_processing_days                                      : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_term_extension                                       : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ gov_interest_statement                                      : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_uspc_current_mainclass_average_patent_processing_days: logi [1:10..</span></span></code></pre></div>
<p>Now we are left with a series of flat data frames instead of having a
single data frame with other data frames nested inside of it. These flat
data frames can be joined together as needed via the primary key
(<code>assignee_id</code>).</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Baker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
