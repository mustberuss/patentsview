<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started • patentsview</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">patentsview</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-api-changes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-flag"></span> API Changes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-api-changes">
<li><a class="dropdown-item" href="../articles/api-changes.html"><span class="fa fa-exclamation"></span> 2025 API Changes</a></li>
    <li><a class="dropdown-item" href="../articles/converting-an-existing-script.html"><span class="fa fa-sync"></span> Converting an Existing Script</a></li>
    <li><a class="dropdown-item" href="../articles/result-set-paging.html"><span class="fa fa-book"></span> Result Set Paging</a></li>
    <li><a class="dropdown-item" href="../articles/understanding-the-api.html"><span class="fa fa-school"></span> Understanding the API</a></li>
  </ul>
</li>
<li class="active nav-item"><a class="nav-link" href="../articles/getting-started.html"><span class="fa fa-play"></span> Getting started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/writing-queries.html"><span class="fa fa-pencil"></span> Writing queries</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-bar-chart"></span> Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications">
<li><a class="dropdown-item" href="../articles/examples.html"><span class="fa fa-code"></span> Examples</a></li>
    <li><a class="dropdown-item" href="../articles/top-assignees.html"><span class="fa fa-university"></span> Top assignees</a></li>
    <li><a class="dropdown-item" href="../articles/citation-networks.html"><span class="fa fa-long-arrow-left"></span> Citation networks</a></li>
    <li><a class="dropdown-item" href="../articles/ropensci-blog-post.html"><span class="fa fa-bullhorn"></span> ropensci announcement</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/patentsview/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/HEAD/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<p>The new version of the API requires an API key, or all of your
requests will be rejected. Request an API key using this link: <a href="https://patentsview-support.atlassian.net/servicedesk/customer/portals" class="external-link uri">https://patentsview-support.atlassian.net/servicedesk/customer/portals</a>
Once you have one, you’ll need to set an environmental variable
PATENTSVIEW_API_KEY to the value of your API key for the R package to
use.</p>
<div class="section level2">
<h2 id="a-basic-example">A basic example<a class="anchor" aria-label="anchor" href="#a-basic-example"></a>
</h2>
<p>Let’s start with a basic example of how to use the package’s primary
function, <code><a href="../reference/search_pv.html">search_pv()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/patentsview/index.html">patentsview</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="st">'{"_gte":{"patent_date":"2007-01-01"}}'</span>,</span>
<span>  endpoint <span class="op">=</span> <span class="st">"patent"</span>,</span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="st">"patent_title"</span>, <span class="st">"patent_date"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id   : chr [1:1000] "10000000" ...</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr [1:1000] "Coherent LADAR using intra-pixel quadrature"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date : chr [1:1000] "2018-06-19" ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 5,710,745</span></span></code></pre></div>
<p>This call to <code><a href="../reference/search_pv.html">search_pv()</a></code> sends our query to the patent
endpoint (the default). The API has 27 endpoints, corresponding to 27
different entity types. patent/rel_app_text and publication/rel_app_text
both both return a rel_app_text entity, though they are slightly
different. Here is the list of entities the API returns: assignees,
attorneys, cpc_classes, cpc_groups, cpc_subclasses, foreign_citations,
g_brf_sum_texts, g_claims, g_detail_desc_texts, g_draw_desc_texts,
inventors, ipcs, locations, otherreferences, pg_brf_sum_texts,
pg_claims, pg_detail_desc_texts, pg_draw_desc_texts, patents,
publications, rel_app_texts, us_application_citations,
us_patent_citations, uspc_mainclasses, uspc_subclasses, wipo.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;You can use &lt;code&gt;&lt;a href="../reference/get_endpoints.html"&gt;get_endpoints()&lt;/a&gt;&lt;/code&gt; to list the
endpoint names the R package uses.&lt;/p&gt;'><sup>1</sup></a> Your
choice of endpoint determines which entity your query is applied to, as
well as the structure of the data that is returned (more on this in the
“27 endpoints for 27 entities section”). For now, let’s turn our
attention to the <code>query</code> parameter.</p>
</div>
<div class="section level2">
<h2 id="writing-queries">Writing queries<a class="anchor" aria-label="anchor" href="#writing-queries"></a>
</h2>
<p>The PatentsView query syntax is documented on their <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#api-query-language" class="external-link">query
language page</a> note also the change to the Options parameter for the
new version of the API mentioned on that page.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This webpage includes some details that are not relevant
to the &lt;code&gt;query&lt;/code&gt; argument in &lt;code&gt;search_pv&lt;/code&gt;, such as
the field list and sort parameter.&lt;/p&gt;"><sup>2</sup></a> However, it can be
difficult to get your query right if you’re writing it by hand (i.e.,
just writing the query in a string like
<code>'{"_gte":{"patent_date":"2007-01-01"}}'</code>, as we did in the
example shown above). The <code>patentsview</code> package comes with a
simple domain specific language (DSL) to make writing queries a breeze.
I recommend using the functions in this DSL for all but the most basic
queries, especially if you’re encountering errors and don’t understand
why. To get a feel for how it works, let’s rewrite the query shown above
using one of the functions in the DSL, <code>qry_funs$gte()</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qry_funs</span><span class="op">$</span><span class="fu">gte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2007-01-01"</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_gte":{"patent_date":"2007-01-01"}}</span></span></code></pre></div>
<p>More complex queries are also possible:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">and</a></span><span class="op">(</span></span>
<span>    <span class="fu">gte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2007-01-01"</span><span class="op">)</span>,</span>
<span>    <span class="fu">text_phrase</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"computer program"</span>, <span class="st">"dog leash"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_and":[{"_gte":{"patent_date":"2007-01-01"}},{"_or":[{"_text_phrase":{"patent_abstract":"computer program"}},{"_text_phrase":{"patent_abstract":"dog leash"}}]}]}</span></span></code></pre></div>
<p>Check out the <a href="writing-queries.html">writing queries
vignette</a> for more details on using the DSL.</p>
</div>
<div class="section level2">
<h2 id="fields">Fields<a class="anchor" aria-label="anchor" href="#fields"></a>
</h2>
<p>Each endpoint has a different set of fields. The new version of the
API allows all fields to be queried. You can specify which fields you
want using the <code>fields</code> argument. If you don’t specify any,
you will get the primary key(s) for the specified endpoint.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># search_pv defaults the endpoint parameter to "patent" if not specified</span></span>
<span><span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="st">'{"_gte":{"patent_date":"2007-01-01"}}'</span>,</span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="st">"patent_title"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id   : chr [1:1000] "10000000" ...</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr [1:1000] "Coherent LADAR using intra-pixel quadrature"..</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 5,710,745</span></span></code></pre></div>
<p>To list all of the fields for a given endpoint, use
<code><a href="../reference/get_fields.html">get_fields()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">retrvble_flds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patent"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">retrvble_flds</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "applicants.applicant_designation"  "applicants.applicant_name_first"  </span></span>
<span><span class="co">#&gt; [3] "applicants.applicant_name_last"    "applicants.applicant_organization"</span></span>
<span><span class="co">#&gt; [5] "applicants.applicant_sequence"     "applicants.applicant_type"</span></span></code></pre></div>
<p>Nested fields can be fully qualified or a new API shorthand can be
used, where group names can specified. When group names are used, all of
the group’s nested fields will be returned by the API. E.g., the new
version of the API and R package will accept
<code>fields=c("applicants")</code></p>
<p>See the <a href="https://search.patentsview.org/swagger-ui/" class="external-link">Swagger
UI page</a> for the API, the fields returned are listed for each
endpoint in the 200 Response body sections. The <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#endpoints" class="external-link">API’s
endpoint documentation</a> has a similar look and feel.</p>
<p>You can also visit an endpoint’s online documentation page to see a
list of its fields (e.g., see the <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#inventor" class="external-link">inventor
field list table</a>). In earlier versions of the API not all fields
were queryable as they are now. The field tables for all of the
endpoints can be found in the <code>fieldsdf</code> data frame, which
you can load using <code>data("fieldsdf")</code> or
<code>View(patentsview::fieldsdf)</code>.</p>
<p><strong>An important note: PatentsView uses disambiguated versions of
assignees, inventors, and locations, instead of raw data.</strong> For
example, let’s say you search for all inventors whose first name is
“john.” The PatentsView API is going to return all of the inventors who
have a preferred first name (as per the disambiguation results) of john,
which may not necessarily be their raw first name. You could be getting
back inventors whose first name appears on the patent as, say,
“jonathan,” “johnn,” or even “john jay.”, see the <a href="https://patentsview.org/disambiguation" class="external-link">PatentsView Inventor
Disambiguation Technical Workshop website</a>.</p>
<p>In the original version of the API, rawinventor_first_name and
rawinventor_last_name were available from the patents, inventors and
assignees endpoints. <strong>In the new version of the API these fields
are no longer available.</strong></p>
</div>
<div class="section level2">
<h2 id="paginated-responses">Paginated responses<a class="anchor" aria-label="anchor" href="#paginated-responses"></a>
</h2>
<p>By default, <code><a href="../reference/search_pv.html">search_pv()</a></code> returns 1,000 records per page
and only gives you the first page of results. I suggest starting with
something smaller, like the <code>size</code> = 150 below, while you’re
figuring out the details of your request, such as the query you want to
use and the fields you want returned. Once you have those items
finalized, you can use the <code>size</code> argument to download up to
1,000 records per page.</p>
<p>You can download all pages of output in one call by setting
<code>all_pages = TRUE</code>. This will set <code>size</code> equal to
1,000 and loop over all pages of output:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="st">"inventors.inventor_name_last"</span>, <span class="st">"inventors.inventor_name_first"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Chambers"</span><span class="op">)</span>,</span>
<span>  all_pages <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">1000</span>, fields <span class="op">=</span> <span class="va">fields</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 2518 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id: chr [1:2518] "10000988" ...</span></span>
<span><span class="co">#&gt;   ..$ inventors:List of 2518</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 2,518</span></span></code></pre></div>
<p>See the <a href="result-set-paging.html">result set paging
vignette</a> for information on custom paging.</p>
</div>
<div class="section level2">
<h2 id="entity-counts">Entity counts<a class="anchor" aria-label="anchor" href="#entity-counts"></a>
</h2>
<p>Our last two calls to <code><a href="../reference/search_pv.html">search_pv()</a></code> gave the same value
for <code>total_hits</code>, even though we got a lot more data from the
second call. This is because the entity counts returned by the API refer
to the number of distinct entities across all <em>downloadable pages of
output</em>, not just the page that was returned.</p>
</div>
<div class="section level2">
<h2 id="endpoints-for-27-entities">27 endpoints for 27 entities<a class="anchor" aria-label="anchor" href="#endpoints-for-27-entities"></a>
</h2>
<p>With the recent API change, the patent endpoint supplies the basic
patent data and the other endpoints return more specific data for those
patents.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_endpoints.html">get_endpoints</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "assignee"                       "cpc_class"                     </span></span>
<span><span class="co">#&gt;  [3] "cpc_group"                      "cpc_subclass"                  </span></span>
<span><span class="co">#&gt;  [5] "g_brf_sum_text"                 "g_claim"                       </span></span>
<span><span class="co">#&gt;  [7] "g_detail_desc_text"             "g_draw_desc_text"              </span></span>
<span><span class="co">#&gt;  [9] "inventor"                       "ipc"                           </span></span>
<span><span class="co">#&gt; [11] "location"                       "patent"                        </span></span>
<span><span class="co">#&gt; [13] "patent/attorney"                "patent/foreign_citation"       </span></span>
<span><span class="co">#&gt; [15] "patent/other_reference"         "patent/rel_app_text"           </span></span>
<span><span class="co">#&gt; [17] "patent/us_application_citation" "patent/us_patent_citation"     </span></span>
<span><span class="co">#&gt; [19] "pg_brf_sum_text"                "pg_claim"                      </span></span>
<span><span class="co">#&gt; [21] "pg_detail_desc_text"            "pg_draw_desc_text"             </span></span>
<span><span class="co">#&gt; [23] "publication"                    "publication/rel_app_text"      </span></span>
<span><span class="co">#&gt; [25] "uspc_mainclass"                 "uspc_subclass"                 </span></span>
<span><span class="co">#&gt; [27] "wipo"</span></span>
<span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Chambers"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Here we'll request patent_id and the inventor fields from the patent endpoint</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patent"</span>, groups <span class="op">=</span><span class="st">"inventors"</span><span class="op">)</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="va">fields</span><span class="op">)</span></span>
<span><span class="va">fields</span></span>
<span><span class="co">#&gt; [1] "patent_id"                     "inventors.inventor_id"        </span></span>
<span><span class="co">#&gt; [3] "inventors.inventor_city"       "inventors.inventor_country"   </span></span>
<span><span class="co">#&gt; [5] "inventors.inventor_name_first" "inventors.inventor_name_last" </span></span>
<span><span class="co">#&gt; [7] "inventors.inventor_sequence"   "inventors.inventor_state"</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">query</span>, endpoint <span class="op">=</span> <span class="st">"patent"</span>, fields <span class="op">=</span> <span class="va">fields</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id: chr [1:1000] "10000988" ...</span></span>
<span><span class="co">#&gt;   ..$ inventors:List of 1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 2,518</span></span>
<span></span>
<span><span class="co"># Here's the first inventors</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patents</span><span class="op">$</span><span class="va">inventors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                                                  inventor</span></span>
<span><span class="co">#&gt; 1   https://search.patentsview.org:80/api/v1/inventor/fl:si_ln:harrall-1/</span></span>
<span><span class="co">#&gt; 2   https://search.patentsview.org:80/api/v1/inventor/fl:da_ln:wagoner-1/</span></span>
<span><span class="co">#&gt; 3   https://search.patentsview.org:80/api/v1/inventor/fl:th_ln:bailey-10/</span></span>
<span><span class="co">#&gt; 4     https://search.patentsview.org:80/api/v1/inventor/fl:an_ln:barry-8/</span></span>
<span><span class="co">#&gt; 5 https://search.patentsview.org:80/api/v1/inventor/fl:ja_ln:chambers-11/</span></span>
<span><span class="co">#&gt;            inventor_id inventor_name_first inventor_name_last</span></span>
<span><span class="co">#&gt; 1   fl:si_ln:harrall-1            Simon J.            Harrall</span></span>
<span><span class="co">#&gt; 2   fl:da_ln:wagoner-1            Danny W.            Wagoner</span></span>
<span><span class="co">#&gt; 3   fl:th_ln:bailey-10           Thomas F.             Bailey</span></span>
<span><span class="co">#&gt; 4     fl:an_ln:barry-8        Andrew A. W.              Barry</span></span>
<span><span class="co">#&gt; 5 fl:ja_ln:chambers-11            James W.           Chambers</span></span>
<span><span class="co">#&gt;   inventor_gender_code                 inventor_location_id inventor_city</span></span>
<span><span class="co">#&gt; 1                    M 4e49a0a0-16c8-11ed-9b5f-1234bde3cd05       Houston</span></span>
<span><span class="co">#&gt; 2                    M d22da190-16c7-11ed-9b5f-1234bde3cd05       Cypress</span></span>
<span><span class="co">#&gt; 3                    M 4e49a0a0-16c8-11ed-9b5f-1234bde3cd05       Houston</span></span>
<span><span class="co">#&gt; 4                    M db9fa2c2-16c7-11ed-9b5f-1234bde3cd05 Missouri City</span></span>
<span><span class="co">#&gt; 5                    M da44dff7-16c7-11ed-9b5f-1234bde3cd05       Hackett</span></span>
<span><span class="co">#&gt;   inventor_state inventor_country inventor_sequence</span></span>
<span><span class="co">#&gt; 1             TX               US                 4</span></span>
<span><span class="co">#&gt; 2             TX               US                 1</span></span>
<span><span class="co">#&gt; 3             TX               US                 0</span></span>
<span><span class="co">#&gt; 4             TX               US                 3</span></span>
<span><span class="co">#&gt; 5             AR               US                 2</span></span>
<span></span>
<span><span class="co"># Now we will see what the inventor endpoint returns for a similar query.</span></span>
<span><span class="co"># We use get_fields() to get all the available for the inventor endpoint.</span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventor_name_last <span class="op">=</span> <span class="st">"Chambers"</span><span class="op">)</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"inventor"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">query</span>, endpoint <span class="op">=</span> <span class="st">"inventor"</span>, fields <span class="op">=</span> <span class="va">fields</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on inventors level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ inventors:'data.frame':   440 obs. of  16 variables:</span></span>
<span><span class="co">#&gt;   ..$ inventor_id                 : chr [1:440] "1vk0dcohf8r1vofo538cfxl2g" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_name_first         : chr [1:440] "Gilbert V." ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_name_last          : chr [1:440] "Chambers" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_gender_code        : chr [1:440] "M" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_city     : chr [1:440] "Baytown" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_state    : chr [1:440] "TX" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_country  : chr [1:440] "US" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_latitude : num [1:440] 29.7 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_longitude: num [1:440] -95 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_lastknown_location : chr [1:440] "https://search.patentsview.o"..</span></span>
<span><span class="co">#&gt;   ..$ inventor_num_patents        : int [1:440] 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_num_assignees      : int [1:440] 1 2 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_first_seen_date    : chr [1:440] "1995-10-17" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_last_seen_date     : chr [1:440] "1995-10-17" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_years_active       : num [1:440] 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_years              :List of 440</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 440</span></span></code></pre></div>
<p>Your choice of endpoint determines two things:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Which entity your query is applied to.</strong> The first
call shown above used the patent endpoint, so the API searched for
patents that have at least one inventor listed on them with the last
name “Chambers.” The second call used the inventor endpoint to show what
it returns for a similar query.</p></li>
<li><p><strong>The structure of the data frame that is
returned.</strong> The first call returned a data frame on the patent
level, meaning that each row corresponded to a different patent. Fields
that were not on the patent level (e.g.,
<code>inventors.inventor_name_last</code>) were returned in list columns
that are named after the entity associated with the field (e.g., the
<code>inventors</code> entity).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;You can unnest the data frames that are stored in the
list columns using &lt;code&gt;&lt;a href="../reference/unnest_pv_data.html"&gt;unnest_pv_data()&lt;/a&gt;&lt;/code&gt;. See the FAQs for
details.&lt;/p&gt;'><sup>3</sup></a> Meanwhile, the second call gave us a data
frame on the inventor level (one row for each inventor) because it used
the inventor endpoint.</p></li>
</ol>
<p>Most of the time you will want to use the patent endpoint. Note that
you can still effectively filter on fields that are not at the
patent-level when using the patent endpoint (e.g., you can filter on
assignee name or CPC category). This is because patents are relatively
low-level entities. For higher level entities like assignees, if you
filter on a field that is not at the assignee-level (e.g., inventor
name), the API will return data on any assignee that has at least one
inventor whose name matches your search, which is probably not what you
want.</p>
</div>
<div class="section level2">
<h2 id="faqs">FAQs<a class="anchor" aria-label="anchor" href="#faqs"></a>
</h2>
<div class="section level4">
<h4 id="im-sure-my-query-is-well-formatted-and-correct-but-i-keep-getting-an-error--whats-the-deal">I’m sure my query is well formatted and correct but I keep getting
an error. What’s the deal?<a class="anchor" aria-label="anchor" href="#im-sure-my-query-is-well-formatted-and-correct-but-i-keep-getting-an-error--whats-the-deal"></a>
</h4>
<p>The API query syntax guidelines do not cover all of the API’s
behavior. Specifically, there are several things that you cannot do
which are not documented on the API’s webpage. The <a href="writing-queries.html">writing queries vignette</a> has more
details on this. You can also try the string version of your query in
the API’s <a href="https://search.patentsview.org/swagger-ui/" class="external-link">Swagger
UI page</a>. Its error messages can sometimes help determine the
problem.</p>
<p>Now that the R package is using httr2, users can make use of its
last_request() method to see what was sent to the API. This could be
useful when trying to fix an invalid request.</p>
<pre><code><span><span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/last_response.html" class="external-link">last_request</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="does-the-api-have-any-rate-limitingthrottling-controls">Does the API have any rate limiting/throttling controls?<a class="anchor" aria-label="anchor" href="#does-the-api-have-any-rate-limitingthrottling-controls"></a>
</h4>
<p>Yes, the API currently allows 45 calls per minute for each API key.
If this limit is exceeded the API will return an http status of 429 with
a response header Retry-After set to the number of seconds to wait
before making subsequent requests. The R package should handle this for
you. You will need to <a href="https://patentsview-support.atlassian.net/servicedesk/customer/portals" class="external-link">request
an API key</a> and set the environmental variable PATENTSVIEW_API_KEY to
the value of your key.</p>
</div>
<div class="section level4">
<h4 id="how-do-i-access-the-data-frames-inside-the-list-columns-returned-by-search_pv">How do I access the data frames inside the list columns returned by
<code>search_pv()</code>?<a class="anchor" aria-label="anchor" href="#how-do-i-access-the-data-frames-inside-the-list-columns-returned-by-search_pv"></a>
</h4>
<p>Let’s consider the following data, in which patents are the primary
entity while “application”, “assignees”, and
“gov_interest_organizations” are the secondary entities (also referred
to as subentities):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create field list -</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="st">"patent_date"</span>, <span class="st">"patent_title"</span>,</span>
<span>  <span class="st">"assignees"</span>, <span class="st">"application"</span>,  <span class="st">"gov_interest_organizations"</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Pull data</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">text_any</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Smith"</span><span class="op">)</span>, </span>
<span>  endpoint <span class="op">=</span> <span class="st">"patent"</span>, </span>
<span>  fields <span class="op">=</span> <span class="va">fields</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id                 : chr [1:1000] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ patent_title              : chr [1:1000] "High kinetic energy penetrato"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date               : chr [1:1000] "2018-06-19" ...</span></span>
<span><span class="co">#&gt;   ..$ application               :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ assignees                 :List of 1000</span></span>
<span><span class="co">#&gt;   ..$ gov_interest_organizations:List of 1000</span></span></code></pre></div>
<p><code>res$data</code> has vector columns for those fields that belong
to the primary entity (e.g., <code>res$data$patents$patent_id</code>)
and list columns for those fields that belong to any secondary entity
(e.g., <code>res$data$patents$gov_interest_organizations</code>). You
have two good ways to pull out the data frames that are nested inside
these list columns:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Use tidyr::unnest.</strong> (This is probably the easier
choice of the two).</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     extract</span></span>
<span></span>
<span><span class="co"># Get assignee data:</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patents</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">assignees</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 16</span></span>
<span><span class="co">#&gt;   patent_id patent_title            patent_date application assignee assignee_id</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;                   &lt;chr&gt;       &lt;list&gt;      &lt;chr&gt;    &lt;chr&gt;      </span></span>
<span><span class="co">#&gt; 1 10000036  High kinetic energy pe… 2018-06-19  &lt;df&gt;        https:/… ed9a3765-d…</span></span>
<span><span class="co">#&gt; 2 10000466  Substituted 4,5,6,7-te… 2018-06-19  &lt;df&gt;        https:/… 075c6a75-f…</span></span>
<span><span class="co">#&gt; 3 10000693  Methods and compositio… 2018-06-19  &lt;df&gt;        https:/… 83e9294d-0…</span></span>
<span><span class="co">#&gt; 4 10000750  Method of isolating nu… 2018-06-19  &lt;df&gt;        https:/… c1243da8-6…</span></span>
<span><span class="co">#&gt; 5 10000975  Cutting element         2018-06-19  &lt;df&gt;        https:/… 2644bf4b-e…</span></span>
<span><span class="co">#&gt; 6 10000976  Cutting element         2018-06-19  &lt;df&gt;        https:/… 2644bf4b-e…</span></span>
<span><span class="co">#&gt; # ℹ 10 more variables: assignee_type &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   assignee_individual_name_first &lt;chr&gt;, assignee_individual_name_last &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   assignee_organization &lt;chr&gt;, assignee_location_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   assignee_city &lt;chr&gt;, assignee_state &lt;chr&gt;, assignee_country &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   assignee_sequence &lt;int&gt;, gov_interest_organizations &lt;list&gt;</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Use patentsview::unnest_pv_data.</strong>
<code><a href="../reference/unnest_pv_data.html">unnest_pv_data()</a></code> creates a series of data frames (one for
each entity level) that are like tables in a relational database. You
provide it with the data returned by <code><a href="../reference/search_pv.html">search_pv()</a></code> and a
field that can act as a unique identifier for the primary entities:</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/unnest_pv_data.html">unnest_pv_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">data</span>, pk <span class="op">=</span> <span class="st">"patent_id"</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ application               :'data.frame':  1000 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id       : chr [1:1000] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ application_id  : chr [1:1000] "14/753848" ...</span></span>
<span><span class="co">#&gt;   ..$ application_type: chr [1:1000] "14" ...</span></span>
<span><span class="co">#&gt;   ..$ filing_date     : chr [1:1000] "2015-06-29" ...</span></span>
<span><span class="co">#&gt;   ..$ series_code     : chr [1:1000] "14" ...</span></span>
<span><span class="co">#&gt;   ..$ rule_47_flag    : logi [1:1000] TRUE ...</span></span>
<span><span class="co">#&gt;   ..$ filing_type     : chr [1:1000] "14" ...</span></span>
<span><span class="co">#&gt;  $ assignees                 :'data.frame':  975 obs. of  12 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id                     : chr [1:975] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee                      : chr [1:975] "https://search.patentsview"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_id                   : chr [1:975] "ed9a3765-d611-438b-b01f-a4"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_type                 : chr [1:975] "6" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_individual_name_first: chr [1:975] NA ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_individual_name_last : chr [1:975] NA ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_organization         : chr [1:975] "The United States of Ameri"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_location_id          : chr [1:975] "fe1dd7c7-16c7-11ed-9b5f-12"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_city                 : chr [1:975] "Washington" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_state                : chr [1:975] "DC" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_country              : chr [1:975] "US" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_sequence             : int [1:975] 0 0 ...</span></span>
<span><span class="co">#&gt;  $ gov_interest_organizations:'data.frame':  43 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id     : chr [1:43] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ fedagency_name: chr [1:43] "National Aeronautics and Space Administrati"..</span></span>
<span><span class="co">#&gt;   ..$ level_one     : chr [1:43] "National Aeronautics and Space Administrati"..</span></span>
<span><span class="co">#&gt;   ..$ level_two     : chr [1:43] NA ...</span></span>
<span><span class="co">#&gt;   ..$ level_three   : chr [1:43] NA ...</span></span>
<span><span class="co">#&gt;  $ patents                   :'data.frame':  1000 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id   : chr [1:1000] "10000036" ...</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr [1:1000] "High kinetic energy penetrator shielding an"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date : chr [1:1000] "2018-06-19" ...</span></span></code></pre></div>
<p>Now we are left with a series of flat data frames instead of having a
single data frame with other data frames nested inside of it. These flat
data frames can be joined together as needed via the primary key
(<code>patent_id</code>) for this endpoint.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Baker, Russ Allen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
