<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="patentsview">
<title>Breaking release of the Patentsview Package • patentsview</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Breaking release of the Patentsview Package">
<meta property="og:description" content="patentsview">
<meta property="og:image" content="https://mustberuss.github.io/patentsview/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">patentsview</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--api-changes">
    <span class="fa fa-flag"></span>
     
    API Changes
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--api-changes">
    <a class="dropdown-item" href="../articles/api-changes.html">
      <span class="fa fa-exclamation"></span>
       
      2024 API Changes
    </a>
    <a class="dropdown-item" href="../articles/converting-an-existing-script.html">
      <span class="fa fa-sync"></span>
       
      Converting an Existing Script
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/getting-started.html">
    <span class="fa fa-play"></span>
     
    Getting started
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/writing-queries.html">
    <span class="fa fa-pencil"></span>
     
    Writing queries
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--applications">
    <span class="fa fa-bar-chart"></span>
     
    Applications
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--applications">
    <a class="dropdown-item" href="../articles/examples.html">
      <span class="fa fa-code"></span>
       
      Examples
    </a>
    <a class="dropdown-item" href="../articles/top-assignees.html">
      <span class="fa fa-university"></span>
       
      Top assignees
    </a>
    <a class="dropdown-item" href="../articles/citation-networks.html">
      <span class="fa fa-long-arrow-left"></span>
       
      Citation networks
    </a>
    <a class="dropdown-item" href="../articles/ropensci_blog_post.html">
      <span class="fa fa-bullhorn"></span>
       
      ropensci announcement
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/patentsview/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Breaking release of the Patentsview Package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/HEAD/vignettes/patentsview-breaking-change.Rmd" class="external-link"><code>vignettes/patentsview-breaking-change.Rmd</code></a></small>
      <div class="d-none name"><code>patentsview-breaking-change.Rmd</code></div>
    </div>

    
    
<p>The Patentsview API team has released a new version of their API,
which is used by a correspondingly new version of the patentsview R
package. The problem for users is that the API team has made
<strong>breaking changes</strong>, existing programs will not run with
the new version of the R package. Please don’t shoot the messenger!</p>
<p>The new version of the R package handles some of the API team’s
changes where possible, however an API key is now required. The
Patentsview API team plans to shutdown the original version of the API
on February 12, 2025. At that time the original version of the R package
will stop working.</p>
<p>The original version of the R package is available on CRAN with the
new version available on r-universe. After the original version of the
API is shutdown, the new R package will be submitted to CRAN.</p>
<div class="section level2">
<h2 id="user-impacting-api-changes">User Impacting API changes:<a class="anchor" aria-label="anchor" href="#user-impacting-api-changes"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Users will need to <a href="https://patentsview.org/apis/keyrequest" class="external-link">request an API key</a>
and set an environmental variable PATENTSVIEW_API_KEY to its
value.</p></li>
<li>
<p>Endpoint changes:</p>
<ul>
<li>The nber_subcategories, one of the original seven endpoints, was
removed</li>
<li>cpc_subsections is now cpc_group</li>
<li>The remaining five original endpoints went from plural to singular,
“patents” is now “patent” for example. Interestingly, the returned data
structures are still plural for the most part.</li>
<li>There are now 23 endpoints, some may need to be called to retrieve
fields that are currently (soon-to-be-were) available from the original
endpoints (now some endpoint’s returns are lighter, requiring additional
calls to be made).</li>
<li>Now some of the endpoints return HATEOAS (Hypermedia as the Engine
of Application State) links to retrieve more data (URLs for additional
calls back to the API)</li>
</ul>
</li>
<li>
<p>Some fields are now nested and need to be fully qualified when
used in a query, e.g.,
<code>search_pv('{"cpc_current.cpc_group_id":"A01B1/00"}')</code> when
using the patent endpoint.</p>
<p>In the fields parameter, nested fields can be fully qualified or a
new API shorthand can be used, where group names can specified. When
group names are used, all of the group’s nested fields will be returned
by the API. Ex. the new version of the API and R package will accept
fields=c(“assignees”) when using the patent endpoint and all nested
assignees fields will be returned by the API.</p>
</li>
<li><p>Some field’s names have changed, most significantly,
patent_number is now patent_id, and some fields were removed entirely,
e.g., rawinventor_first_name and rawinventor_last_name.</p></li>
<li><p>The original version of the API had queryable fields and
additional fields which could be retreived but couldn’t be part of a
conditional query. That notion does not apply to the new version of the
API as all fields are now queryable. You may be able to simplify your
code if you found yourself doing post processing on returned data
because a field you were interested in was not queryable.</p></li>
<li><p>Currently not working properly, there isn’t supposed to be a
difference between operators used on full text fields, as there was in
the original version of the API. See the tip below the Syntax section <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#syntax" class="external-link">here</a>.
Note that the result sizes aren’t matching currently though, see <a href="https://github.com/mustberuss/patentsview/blob/api-redesign/tests/testthat/test-api-bugs.R" class="external-link">testthat/test-api-bugs.R</a></p></li>
</ol>
<p>The API team also renamed the API, PatentsView’s Search API is now
the PatentSearch API, as announced <a href="https://search.patentsview.org/docs/#naming-update" class="external-link">here</a>. Note
that the R package will retain its name, continue to use
library(patentsview)</p>
</div>
<div class="section level2">
<h2 id="highlights-of-the-r-package">Highlights of the R package:<a class="anchor" aria-label="anchor" href="#highlights-of-the-r-package"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Throttling is now enforced by the API and handled by the R package
(sleep as specified by the throttle response then retry)</li>
<li>There are two new vignettes
<ul>
<li>There is a new “Converting an existing script” vignette</li>
<li>The <a href="https://ropensci.org/blog/2017/09/19/patentsview/" class="external-link">ropensci
post</a> that announced the original version of the R package has been
changed to work with the new version of the API and is now a new
vignette.</li>
</ul>
</li>
<li>A hex sticker was created using GuangchuangYu’s <a href="https://github.com/GuangchuangYu/hexSticker" class="external-link">hexSticker</a>
</li>
<li>Two new functions were added
<ul>
<li>retrieve_linked_data() to retrieve data from a HATEOAS link the API
sent back, retrying if throttled</li>
<li>qry_funs$in_range() to generate range queries for you.</li>
</ul>
</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mustberuss.github.io/patentsview/index.html">patentsview</a></span><span class="op">)</span></span>
<span><span class="va">qry_funs</span><span class="op">$</span><span class="fu">in_range</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1976-01-01"</span>, <span class="st">"1983-02-28"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_and":[{"_gte":{"patent_date":"1976-01-01"}},{"_lte":{"patent_date":"1983-02-28"}}]}</span></span>
<span></span>
<span><span class="va">qry_funs</span><span class="op">$</span><span class="fu">in_range</span><span class="op">(</span>patent_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2010</span>, <span class="fl">2021</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_and":[{"_gte":{"patent_year":2010}},{"_lte":{"patent_year":2021}}]}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="online-documentation">Online Documentation<a class="anchor" aria-label="anchor" href="#online-documentation"></a>
</h2>
<p>The API team has thoughtfully provided a Swagger UI page for the new
version of the API at <a href="https://search.patentsview.org/swagger-ui/" class="external-link uri">https://search.patentsview.org/swagger-ui/</a>. Think of it
as an online version of Postman already loaded with the API’s new
endpoints and returns. The Swagger UI page documents what fields are
returned by each endpoint on a successful call. (Response http code
200). You can even send in requests and see actual API responses if you
enter your API key and press an endpoint’s “Try it out” and “Execute”
buttons. Even error responses can be informative, usually pointing out
what went wrong.</p>
<p>In a similar format, the <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#endpoints" class="external-link">updated
API documentation</a> lists what each endpoint does. Additionally, the R
package’s fieldsdf data frame has been updated, now listing the new set
of endpoints and retrievable/queryable fields. The R package’s reference
pages have also been updated.</p>
</div>
<div class="section level2">
<h2 id="final-thoughts">Final Thoughts<a class="anchor" aria-label="anchor" href="#final-thoughts"></a>
</h2>
<p>As shown in the updated Top Assignees vignette, there will be
occasions now where multiple API calls are needed to retrieve the same
data as in a single API call in the original version of the API and R
package. Additionally, the reworked ropensci post explains what changes
had to be made since assignee latitude and longitude are no longer
available from the patent endpoint.</p>
<p>Please open issues for the R package <a href="https://github.com/ropensci/patentsview/issues" class="external-link">here</a>. Issues
or questions about the API itself can be raised <a href="https://patentsview-support.atlassian.net/servicedesk/customer/portals" class="external-link">here</a>
or in the API’s <a href="https://patentsview.org/forum" class="external-link">forum</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Baker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
