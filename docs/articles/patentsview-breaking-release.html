<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Breaking Release of the Patentsview Package • patentsview</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Breaking Release of the Patentsview Package">
<meta name="description" content="Breaking Release of the Patentsview Package">
<meta property="og:description" content="Breaking Release of the Patentsview Package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">patentsview</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-api-changes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-flag"></span> API Changes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-api-changes">
<li><a class="dropdown-item" href="../articles/api-changes.html"><span class="fa fa-exclamation"></span> 2025 API Changes</a></li>
    <li><a class="dropdown-item" href="../articles/converting-an-existing-script.html"><span class="fa fa-sync"></span> Converting an Existing Script</a></li>
    <li><a class="dropdown-item" href="../articles/result-set-paging.html"><span class="fa fa-book"></span> Result Set Paging</a></li>
    <li><a class="dropdown-item" href="../articles/understanding-the-api.html"><span class="fa fa-school"></span> Understanding the API</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/getting-started.html"><span class="fa fa-play"></span> Getting started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/writing-queries.html"><span class="fa fa-pencil"></span> Writing queries</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-bar-chart"></span> Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications">
<li><a class="dropdown-item" href="../articles/examples.html"><span class="fa fa-code"></span> Examples</a></li>
    <li><a class="dropdown-item" href="../articles/top-assignees.html"><span class="fa fa-university"></span> Top assignees</a></li>
    <li><a class="dropdown-item" href="../articles/citation-networks.html"><span class="fa fa-long-arrow-left"></span> Citation networks</a></li>
    <li><a class="dropdown-item" href="../articles/ropensci-blog-post.html"><span class="fa fa-bullhorn"></span> ropensci announcement</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/patentsview/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Breaking Release of the Patentsview Package</h1>
                        <h4 data-toc-skip class="author">Russ Allen</h4>
                        <h4 data-toc-skip class="author">Chris
Baker</h4>
            
            <h4 data-toc-skip class="date">2025-03-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/HEAD/vignettes/articles/patentsview-breaking-release.Rmd" class="external-link"><code>vignettes/articles/patentsview-breaking-release.Rmd</code></a></small>
      <div class="d-none name"><code>patentsview-breaking-release.Rmd</code></div>
    </div>

    
    
<p><em>This is a proposed Tech Note to be submitted to rOpenSci. It’s
here as an Rmd so it will be knitted by the build process but can be
submitted as an md file.</em></p>
<p>The Patentsview API team has released a new version of their API,
which is used by a correspondingly new version of the <a href="https://docs.ropensci.org/patentsview/" class="external-link">patentsview</a> R package.
The problem for users is that the API team has made <strong>breaking
changes</strong>, existing programs will not run with the new version of
the R package. Please don’t shoot the messenger!</p>
<p>The new version of the R package handles some of the API team’s
changes where possible, however an API key is now required. The
Patentsview API team plans to shutdown the original version of the API
in the near future. At that time the original version of the R package
will stop working.</p>
<p>The original version of the R package is available on CRAN with the
new version available on <a href="https://ropensci.r-universe.dev/patentsview" class="external-link">r-universe</a>. After
the original version of the API is shutdown, the updated R package will
be submitted to CRAN.</p>
<div class="section level2">
<h2 id="user-impacting-api-changes">User Impacting API changes:<a class="anchor" aria-label="anchor" href="#user-impacting-api-changes"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Users will need to <a href="https://patentsview-support.atlassian.net/servicedesk/customer/portals" class="external-link">request
an API key</a> and set an environmental variable PATENTSVIEW_API_KEY to
its value.</p></li>
<li>
<p>Endpoint changes:</p>
<ul>
<li>The nber_subcategories, one of the original seven endpoints, was
removed</li>
<li>cpc_subsections is now cpc_group</li>
<li>The remaining five original endpoints went from plural to singular,
“patents” is now “patent” for example. Interestingly, the returned data
structures are still plural for the most part.</li>
<li>There are now 27 endpoints, some may need to be called to retrieve
fields that are currently (soon-to-be-were) available from the original
endpoints (now some endpoint’s returns are lighter, requiring additional
calls to be made).</li>
<li>Now some of the endpoints return HATEOAS (Hypermedia as the Engine
of Application State) links to retrieve more data (URLs for additional
calls back to the API)</li>
</ul>
</li>
<li>
<p>Some fields are now nested and need to be fully qualified when
used in a query, for instance,
<code>search_pv('{"cpc_current.cpc_group_id":"A01B1/00"}')</code> when
using the patent endpoint.</p>
<p>In the fields parameter, nested fields can be fully qualified or a
new API shorthand can be used, where group names can specified. When
group names are used, all of the group’s nested fields will be returned
by the API. For example, the new version of the API and R package will
accept fields=c(“assignees”) when using the patent endpoint and all
nested assignees’ fields will be returned by the API.</p>
</li>
<li><p>Some field’s names have changed, most significantly,
patent_number is now patent_id, and some fields were removed entirely,
for instance, rawinventor_first_name and rawinventor_last_name.</p></li>
<li><p>The original version of the API had queryable fields and
additional fields which could be retrieved but couldn’t be part of a
conditional query. That notion does not apply to the new version of the
API as all fields are now queryable. You may be able to simplify your
code if you found yourself doing post processing on returned data
because a field you were interested in was not queryable.</p></li>
<li><p>Now there isn’t supposed to be a difference between operators
used on strings vs full text fields, as there was in the original
version of the API. See the tip below the <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#syntax" class="external-link">Syntax
section</a>.</p></li>
<li><p>Result set paging has changed significantly. This would matter
only if users implemented their own paging, the R package continues to
handle result set paging when search_pv’s <code>all_pages = TRUE</code>.
There is a new result set paging vignette to explain the way the API now
pages, using the <code>size</code> and <code>after</code> parameters
rather than using <code>per_page</code> and <code>page</code>.</p></li>
<li><p>Result set sizes are seemingly unbounded now. The original
version of the API capped result sets at 100,000 rows.</p></li>
</ol>
<p>The API team also <a href="https://search.patentsview.org/docs/#naming-update" class="external-link">renamed the
API</a>, PatentsView’s Search API is now the PatentSearch API. Note that
the R package will retain its name, continue to use
<code><a href="https://docs.ropensci.org/patentsview/index.html">library(patentsview)</a></code></p>
</div>
<div class="section level2">
<h2 id="highlights-of-the-r-package">Highlights of the R package:<a class="anchor" aria-label="anchor" href="#highlights-of-the-r-package"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Throttling is now enforced by the API and handled by the R package
(sleep as specified by the throttle response before retry)</li>
<li>There are four new vignettes
<ul>
<li>There is a new “Converting an existing script” vignette</li>
<li>The <a href="/blog/2017/09/19/patentsview/">rOpenSci post</a> that
announced the original version of the R package has been changed to work
with the new version of the API and is now a new vignette.</li>
<li>Understanding the API, the API team’s jupyter notebook, converted to
R</li>
<li>On writing custom result set paging</li>
</ul>
</li>
<li>The R package changed internally from using httr to httr2. This only
affects users if they passed additional arguments (…) to
<code><a href="../reference/search_pv.html">search_pv()</a></code>. Previously if they passed config =
httr::timeout(40) they’d now pass timeout = 40 (name-value pairs of
valid curl options, as found in curl::curl_options() see <a href="https://httr2.r-lib.org/reference/req_options.html" class="external-link">req_options</a>)</li>
<li>Now that the R package is using httr2, users can make use of its
last_request() method to see what was sent to the API. This could be
useful when trying to fix an invalid request. Also fun would be seeing
the raw API response.</li>
</ol>
<pre><code><span><span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/last_response.html" class="external-link">last_request</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/last_response.html" class="external-link">last_response</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/last_response.html" class="external-link">last_response</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link">resp_body_json</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre>
<ol start="6" style="list-style-type: decimal">
<li>A new function was added
<ul>
<li>
<code><a href="../reference/retrieve_linked_data.html">retrieve_linked_data()</a></code> to retrieve data from a HATEOAS
link the API sent back, retrying if throttled</li>
</ul>
</li>
<li>An existing function was removed. With the API changes, there is
less of a need for cast_pv_data() which was previously part of the R
package. The API now returns most fields as appropriate types, boolean,
numeric etc., instead of always returning strings.</li>
</ol>
</div>
<div class="section level2">
<h2 id="online-documentation">Online Documentation<a class="anchor" aria-label="anchor" href="#online-documentation"></a>
</h2>
<p>The API team has thoughtfully provided a Swagger UI page for the new
version of the API at <a href="https://search.patentsview.org/swagger-ui/" class="external-link uri">https://search.patentsview.org/swagger-ui/</a>. Think of it
as an online version of Postman already loaded with the API’s new
endpoints and returns. The Swagger UI page documents what fields are
returned by each endpoint on a successful call. (Response http code
200). You can even send in requests and see actual API responses if you
enter your API key and press an endpoint’s “Try it out” and “Execute”
buttons. Even error responses can be informative, usually pointing out
what went wrong.</p>
<p>In a similar format, the <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#endpoints" class="external-link">updated
API documentation</a> lists what each endpoint does. Additionally, the R
package’s fieldsdf data frame has been updated, now listing the new set
of endpoints and fields that can be queried and/or returned. The R
package’s reference pages have also been updated.</p>
</div>
<div class="section level2">
<h2 id="final-thoughts">Final Thoughts<a class="anchor" aria-label="anchor" href="#final-thoughts"></a>
</h2>
<p>As shown in the updated Top Assignees vignette, there will be
occasions now where multiple API calls are needed to retrieve the same
data as in a single API call in the original version of the API and R
package. Additionally, the reworked rOpenSci post explains what changes
had to be made since assignee latitude and longitude are no longer
available from the patent endpoint.</p>
<p>Issues or questions about the API itself can be raised in the <a href="https://patentsview-support.atlassian.net/servicedesk/customer/portals" class="external-link">API’s
portal</a> or in the API’s <a href="https://patentsview.org/forum" class="external-link">forum</a>. Issues for the R package
can be raised in the <a href="https://github.com/ropensci/patentsview/issues" class="external-link">patentsview
repo</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Baker, Russ Allen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
