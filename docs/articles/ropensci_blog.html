<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Patentsview Follow Up Blog • patentsview</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Patentsview Follow Up Blog">
<meta property="og:description" content="patentsview">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patentsview</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-flag"></span>
     
    API Changes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/api-changes.html">
        <span class="fas fa-exclamation"></span>
         
        2022 API Changes
      </a>
    </li>
    <li>
      <a href="../articles/converting-an-existing-script.html">
        <span class="fas fa-sync"></span>
         
        Converting an Existing Script
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/getting-started.html">
    <span class="fas fa-play"></span>
     
    Getting started
  </a>
</li>
<li>
  <a href="../articles/writing-queries.html">
    <span class="fas fa-pencil"></span>
     
    Writing queries
  </a>
</li>
<li>
  <a href="../articles/examples.html">
    <span class="fas fa-code"></span>
     
    Examples
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-bar-chart"></span>
     
    Applications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/top-assignees.html">
        <span class="fas fa-university"></span>
         
        Top assignees
      </a>
    </li>
    <li>
      <a href="../articles/citation-networks.html">
        <span class="fas fa-long-arrow-left"></span>
         
        Citation networks
      </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fas fa-info-circle"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="https://github.com/ropensci/patentsview">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ropensci_blog_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Patentsview Follow Up Blog</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/master/vignettes/ropensci_blog.Rmd"><code>vignettes/ropensci_blog.Rmd</code></a></small>
      <div class="hidden name"><code>ropensci_blog.Rmd</code></div>

    </div>

    
    
<blockquote>
<p>Here we rework sections of the <a href="https://ropensci.org/blog/2017/09/19/patentsview/">ropensci
post</a> from the launch of the patentsview R package, in case a follow
up post is needed. Things are a wee bit different now with the new
version of the API…</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>From the original post:</li>
</ol>
<blockquote>
<ul>
<li>The API is free (no credential required) and currently doesn’t
impose rate limits/bandwidth throttling.</li>
</ul>
</blockquote>
<p>An API key is now required and throttling is imposed (handled by the
new version of the R package) at 45 requests per minute.</p>
<blockquote>
<ul>
<li>The project offers <a href="https://patentsview.org/download/data-download-tables">bulk
downloads of patent data</a> on their website (in a flat file format),
for those who want to be closest to the data.</li>
</ul>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li><p>The next bullet point has a link to the downloads page that’s a
404 now, fixed above.</p></li>
<li><p>The first two examples still work form the original blog, though
now the maximum result set size is 10,000, down from 100,000 and
“total_hits” is returned instead of an endpoint specific count, ex.
total_patent_count.</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/patentsview/index.html">patentsview</a></span><span class="op">)</span></code></pre></div>
<blockquote>
<p>Patents offer a great opportunity for data analysis</p>
<p>There are two primary reasons for this:</p>
<p>Patent data is public. In return for the exclusive right to profit
off an invention, an individual/company has to publicly disclose the
details of their invention to the rest of the world. <a href="http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&amp;r=11&amp;f=G&amp;l=50&amp;co1=AND&amp;d=PTXT&amp;s1=dog&amp;OS=dog&amp;RS=dog">Examples
of those details</a> include the patent’s title, abstract, technology
classification, assigned organizations, etc.</p>
</blockquote>
<ol start="3" style="list-style-type: decimal">
<li>This <a href="https://www.uspto.gov/about-us/news-updates/modern-user-friendly-patent-center-fully-replace-legacy-public-pair-system">press
release</a> says that patft will be going away (url of Examples of those
details)</li>
</ol>
<blockquote>
<p><a href="https://en.wikipedia.org/wiki/United_States_Patent_and_Trademark_Office">United
States Patent and Trademark Office</a> (USPTO) <a href="http://patft.uspto.gov/netahtml/PTO/search-adv.htm">search
engine</a>, or figure out a way to download, parse, and model huge XML
data dumps. Enter PatentsView.</p>
</blockquote>
<ol start="4" style="list-style-type: decimal">
<li>Same problem here, the search engine link would be going way</li>
</ol>
<blockquote>
<h2 id="patentsview-and-the-patentsview-package">PatentsView and the <a href="#patentsview">patentsview</a> package</h2>
<p><a href="https://datatool.patentsview.org/#viz/relationships">PatentsView</a>
is one of USPTO’s new initiatives intended to increase the usability and
value of patent data.</p>
</blockquote>
<ol start="3" style="list-style-type: decimal">
<li>The <a href="https://datatool.patentsview.org/#viz/relationships">PatentsView</a>
link in the original post is now a 404, corrected here and above</li>
</ol>
<p><a href="#query">query</a></p>
<blockquote>
<p>Your query has to use the <a href="https://patentsview.org/apis/api-query-language">PatentsView query
language</a>,</p>
</blockquote>
<ol start="3" style="list-style-type: decimal">
<li>The link in the original post is now a 404, working one above.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qry_1</span> <span class="op">&lt;-</span> <span class="st">'{"_gt":{"patent_year":2007}}'</span>
<span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>query <span class="op">=</span> <span class="va">qry_1</span>, fields <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># This will retrieve a default set of fields</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; [1] "patents"</span>
<span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 25 obs. of  5 variables:</span>
<span class="co">#&gt;   ..$ patent_number     : chr [1:25] "10000000" ...</span>
<span class="co">#&gt;   ..$ patent_title      : chr [1:25] "Coherent LADAR using intra-pixel quadra"..</span>
<span class="co">#&gt;   ..$ patent_date       : chr [1:25] "2018-06-19" ...</span>
<span class="co">#&gt;   ..$ assignees_at_grant:List of 25</span>
<span class="co">#&gt;   ..$ inventors_at_grant:List of 25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_hits = 10,000</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qry_2</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span>patent_year <span class="op">=</span> <span class="fl">2007</span><span class="op">)</span> <span class="co"># All DSL functions are in the qry_funs list</span>
<span class="va">qry_2</span> <span class="co"># qry_2 is the same as qry_1</span>
<span class="co">#&gt; {"_gt":{"patent_year":2007}}</span>

<span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>query <span class="op">=</span> <span class="va">qry_2</span><span class="op">)</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; [1] "patents"</span>
<span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on a patent level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ patents:'data.frame': 25 obs. of  5 variables:</span>
<span class="co">#&gt;   ..$ patent_number     : chr [1:25] "10000000" ...</span>
<span class="co">#&gt;   ..$ patent_title      : chr [1:25] "Coherent LADAR using intra-pixel quadra"..</span>
<span class="co">#&gt;   ..$ patent_date       : chr [1:25] "2018-06-19" ...</span>
<span class="co">#&gt;   ..$ assignees_at_grant:List of 25</span>
<span class="co">#&gt;   ..$ inventors_at_grant:List of 25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_hits = 10,000</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>From the original blog post:<br>
&gt; There are three gotchas to look out for when writing a query:<br>
&gt;<br>
&gt; 1. <strong>Field is queryable.</strong> The API has 7 endpoints
(the default endpoint is “patents”), and each endpoint has its own set
of fields that you can filter on.</li>
</ol>
<p>This needs updating, as now all fields are queryable and there are 13
endpoints (more coming, like /application):</p>
<ol start="5" style="list-style-type: decimal">
<li>The original blog requested inventor_total_num_patents, which we
don’t get from the patents endpoint in the new version of the API. Now
we’d have to call the inventors endpoint to get this field.</li>
</ol>
<blockquote>
<p>search_pv( query = qry_funs$gt(patent_year = 2007), fields =
c(“patent_abstract”, “patent_average_processing_time”,
“inventor_first_name”, “inventor_total_num_patents”)</p>
</blockquote>
<ol start="6" style="list-style-type: decimal">
<li>The original blog’s “begins(cpc_subgroup_id = ‘H04L63/02’)” isn’t
currently possible, the API throws 500 errors when trying to search via
cpc fields. The field may be full text now (some fields switch from
string to full text and vice versa) and insanely, it would have to be
written</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qry_funs</span><span class="op">$</span><span class="fu">text_phrase</span><span class="op">(</span><span class="st">"cpc_current.cpc_subgroup"</span> <span class="op">=</span> <span class="st">"H04L63:02"</span><span class="op">)</span> 
<span class="co">#&gt; {"_text_phrase":{"cpc_current.cpc_subgroup":"H04L63:02"}}</span></code></pre></div>
<p>where a colon is substituted for the slash. HATEOAS links come back
in some of the fields now like these cpc ones:</p>
<pre><code>        {
          "sequence": 18,
          "section_id": "H",
          "cpc_subsection": "https://search.patentsview.org/api/v1/cpc_subsection/H04/",
          "cpc_group": "https://search.patentsview.org/api/v1/cpc_group/H04L/",
          "cpc_subgroup": "https://search.patentsview.org/api/v1/cpc_subgroup/H04L63:02/"
        },</code></pre>
<p>Note the lack of an _id on the cpc fields, cpc_subgroup instead of
cpc_subgroup_id, which will become important below. These links are Get
only with just a url parameter, there is no mechanism to pass the s:, f:
or o: parameters (no need to pannic, the friendly/familiar endpoints
from the initial version of the API are still present.)</p>
<p>Following the “cpc_subgroup” link returns:</p>
<pre><code>{
  "error": false,
  "count": 1,
  "total_hits": 1,
  "cpc_subgroups": [
    {
      "cpc_subgroup_id": "H04L63/02",
      "cpc_subgroup_title": "Network architectures or network communication protocols for network security -for separating internal from external traffic, e.g. firewalls"
    }
  ]
}</code></pre>
<p>Apparently the API team didn’t want to have two url parameters, so in
the HATEOAS link the slash is changed to a colon, though the
cpc_subgroup_id comes back with the slash in place.</p>
<p>There is a new method in the R package to retrive data from the
HATEOAS links.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/retrieve_linked_data.html">retrieve_linked_data</a></span><span class="op">(</span><span class="st">"https://search.patentsview.org/api/v1/cpc_subgroup/H04L63:02/"</span><span class="op">)</span>
<span class="co">#&gt; $data</span>
<span class="co">#&gt; [1] "cpc_subgroups"</span>
<span class="co">#&gt; #### A list with a single data frame on a CPC sub group level:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ cpc_subgroups:'data.frame':   1 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ cpc_subgroup_id   : chr "H04L63/02"</span>
<span class="co">#&gt;   ..$ cpc_subgroup_title: chr "Network architectures or network communication"..</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $query_results</span>
<span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; total_hits = 1</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>The next part of the original blog needs changes, both groups have
new names.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a list of fields:</span>
<span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"patent_number"</span>, <span class="st">"patent_year"</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patents"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"assignees_at_grant"</span>, <span class="st">"cpc_current"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">fields</span>
<span class="co">#&gt;  [1] "patent_number"                   "patent_year"                    </span>
<span class="co">#&gt;  [3] "assignees_at_grant.assignee_id"  "assignees_at_grant.name_first"  </span>
<span class="co">#&gt;  [5] "assignees_at_grant.name_last"    "assignees_at_grant.organization"</span>
<span class="co">#&gt;  [7] "assignees_at_grant.type"         "assignees_at_grant.city"        </span>
<span class="co">#&gt;  [9] "assignees_at_grant.state"        "assignees_at_grant.country"     </span>
<span class="co">#&gt; [11] "assignees_at_grant.latitude"     "assignees_at_grant.longitude"   </span>
<span class="co">#&gt; [13] "cpc_current.sequence"            "cpc_current.section_id"         </span>
<span class="co">#&gt; [15] "cpc_current.subsection_id"       "cpc_current.group_id"           </span>
<span class="co">#&gt; [17] "cpc_current.subgroup_id"         "cpc_current.cpc_group_title"</span></code></pre></div>
<p>As mentioned, searching by any of the cpc fields currently throws a
500 error.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co"># Write a query:</span>
<span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span> <span class="co"># with_qfuns is basically just: with(qry_funs, ...)</span>
  <span class="fu">and</span><span class="op">(</span>
    <span class="fu">text_any</span><span class="op">(</span>cpc_current.cpc_subgroup_id <span class="op">=</span> <span class="st">'H04L63/02'</span><span class="op">)</span>,
    <span class="fu">gte</span><span class="op">(</span>patent_year <span class="op">=</span> <span class="fl">2007</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="co"># Create a list of fields:</span>
<span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"patent_number"</span>, <span class="st">"patent_year"</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patents"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"assignees_at_grant"</span>, <span class="st">"cpc_current"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># Here we won't actually send the request to the server, it would result in a 500</span>
<span class="co"># Send HTTP request to API's server:</span>
<span class="co">#pv_res &lt;- search_pv(query = query, fields = fields, all_pages = TRUE)</span>

<span class="co"># Instead, we'll query for 300 patent numbers returned from the original API</span>
<span class="co"># that matched begins(cpc_subgroup_id = 'H04L63/02')  The sort was by patent_title,</span>
<span class="co"># hoping that will give a random distribution of patent_years (does that matter?)</span>

<span class="co"># When the API is fixed, we'll remove this and make the commented out query above.</span>
<span class="co"># This just lets us move on to see what other changes we have to make to live</span>
<span class="co"># under the new version of the API.</span>

<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"8955089"</span>,<span class="st">"7778228"</span>,<span class="st">"10069797"</span>,<span class="st">"11184318"</span>,<span class="st">"11076281"</span>,<span class="st">"7624431"</span>,<span class="st">"7649848"</span>,<span class="st">"8111620"</span>,<span class="st">"10212133"</span>,<span class="st">"10944724"</span>,<span class="st">"7873060"</span>,<span class="st">"8503332"</span>,<span class="st">"9774570"</span>,<span class="st">"9882878"</span>,<span class="st">"10581737"</span>,<span class="st">"7120692"</span>,<span class="st">"7600036"</span>,<span class="st">"7788404"</span>,<span class="st">"8341275"</span>,<span class="st">"9071574"</span>
,<span class="st">"9331992"</span>,<span class="st">"10397188"</span>,<span class="st">"6219706"</span>,<span class="st">"10089480"</span>,<span class="st">"10963575"</span>,<span class="st">"10880295"</span>,<span class="st">"9363290"</span>,<span class="st">"7475138"</span>,<span class="st">"7805513"</span>,<span class="st">"8181258"</span>,<span class="st">"7853687"</span>,<span class="st">"9509700"</span>,<span class="st">"6377577"</span>,<span class="st">"7023853"</span>,<span class="st">"9749328"</span>,<span class="st">"9794262"</span>,<span class="st">"9584482"</span>,<span class="st">"9712491"</span>,<span class="st">"7054944"</span>,<span class="st">"10764299"</span>
,<span class="st">"9154459"</span>,<span class="st">"9225687"</span>,<span class="st">"9467932"</span>,<span class="st">"6233618"</span>,<span class="st">"10225152"</span>,<span class="st">"10666651"</span>,<span class="st">"11115224"</span>,<span class="st">"10318745"</span>,<span class="st">"9077688"</span>,<span class="st">"7937669"</span>,<span class="st">"9197668"</span>,<span class="st">"6484258"</span>,<span class="st">"10798105"</span>,<span class="st">"8582574"</span>,<span class="st">"10091209"</span>,<span class="st">"10581863"</span>,<span class="st">"9686289"</span>,<span class="st">"9628458"</span>,<span class="st">"9912666"</span>,<span class="st">"8126972"</span>
,<span class="st">"7508767"</span>,<span class="st">"6697806"</span>,<span class="st">"7743158"</span>,<span class="st">"9491625"</span>,<span class="st">"10834136"</span>,<span class="st">"9306943"</span>,<span class="st">"9344296"</span>,<span class="st">"10958662"</span>,<span class="st">"10389722"</span>,<span class="st">"8938794"</span>,<span class="st">"9537755"</span>,<span class="st">"10491633"</span>,<span class="st">"9189644"</span>,<span class="st">"9529989"</span>,<span class="st">"9536070"</span>,<span class="st">"9558334"</span>,<span class="st">"8082579"</span>,<span class="st">"10356619"</span>,<span class="st">"8621570"</span>,<span class="st">"9137231"</span>
,<span class="st">"9949118"</span>,<span class="st">"10623450"</span>,<span class="st">"10681547"</span>,<span class="st">"10805800"</span>,<span class="st">"7698452"</span>,<span class="st">"8688970"</span>,<span class="st">"9240945"</span>,<span class="st">"9514294"</span>,<span class="st">"10049078"</span>,<span class="st">"7251824"</span>,<span class="st">"9525740"</span>,<span class="st">"10798560"</span>,<span class="st">"10050949"</span>,<span class="st">"7653200"</span>,<span class="st">"10911406"</span>,<span class="st">"10567482"</span>,<span class="st">"11115465"</span>,<span class="st">"10171590"</span>,<span class="st">"9560142"</span>,<span class="st">"9344426"</span>
,<span class="st">"8806040"</span>,<span class="st">"10951421"</span>,<span class="st">"10523445"</span>,<span class="st">"9756135"</span>,<span class="st">"10608990"</span>,<span class="st">"11075999"</span>,<span class="st">"8782393"</span>,<span class="st">"9742806"</span>,<span class="st">"7856508"</span>,<span class="st">"10885165"</span>,<span class="st">"7490350"</span>,<span class="st">"10455449"</span>,<span class="st">"8505077"</span>,<span class="st">"10924513"</span>,<span class="st">"10079839"</span>,<span class="st">"10616244"</span>,<span class="st">"10958769"</span>,<span class="st">"8205240"</span>,<span class="st">"10505894"</span>,<span class="st">"10498583"</span>
,<span class="st">"10171425"</span>,<span class="st">"6550012"</span>,<span class="st">"7451489"</span>,<span class="st">"7454499"</span>,<span class="st">"7454792"</span>,<span class="st">"7499412"</span>,<span class="st">"8079075"</span>,<span class="st">"8447039"</span>,<span class="st">"7743155"</span>,<span class="st">"9098459"</span>,<span class="st">"10594029"</span>,<span class="st">"8644206"</span>,<span class="st">"9167426"</span>,<span class="st">"9398453"</span>,<span class="st">"10079754"</span>,<span class="st">"10616279"</span>,<span class="st">"11005816"</span>,<span class="st">"9843622"</span>,<span class="st">"11122065"</span>,<span class="st">"8205259"</span>
,<span class="st">"8448247"</span>,<span class="st">"10498752"</span>,<span class="st">"10235627"</span>,<span class="st">"8489534"</span>,<span class="st">"9684867"</span>,<span class="st">"10425317"</span>,<span class="st">"8406119"</span>,<span class="st">"9170902"</span>,<span class="st">"9674067"</span>,<span class="st">"7912856"</span>,<span class="st">"9306913"</span>,<span class="st">"9660963"</span>,<span class="st">"7774402"</span>,<span class="st">"8639846"</span>,<span class="st">"10362106"</span>,<span class="st">"11019143"</span>,<span class="st">"10326734"</span>,<span class="st">"10616249"</span>,<span class="st">"6185606"</span>,<span class="st">"9288236"</span>
,<span class="st">"10389760"</span>,<span class="st">"10110553"</span>,<span class="st">"9426121"</span>,<span class="st">"11032733"</span>,<span class="st">"6606710"</span>,<span class="st">"11048770"</span>,<span class="st">"11190488"</span>,<span class="st">"10110627"</span>,<span class="st">"10333827"</span>,<span class="st">"7904941"</span>,<span class="st">"8316226"</span>,<span class="st">"7369537"</span>,<span class="st">"10911490"</span>,<span class="st">"8363549"</span>,<span class="st">"9112911"</span>,<span class="st">"9935980"</span>,<span class="st">"10644951"</span>,<span class="st">"7209486"</span>,<span class="st">"10469529"</span>,<span class="st">"8667170"</span>
,<span class="st">"10284504"</span>,<span class="st">"8463938"</span>,<span class="st">"10855644"</span>,<span class="st">"11201847"</span>,<span class="st">"5654985"</span>,<span class="st">"10897459"</span>,<span class="st">"7827313"</span>,<span class="st">"8069469"</span>,<span class="st">"8347353"</span>,<span class="st">"8732796"</span>,<span class="st">"9356836"</span>,<span class="st">"9876822"</span>,<span class="st">"9912701"</span>,<span class="st">"7478420"</span>,<span class="st">"7526800"</span>,<span class="st">"10230531"</span>,<span class="st">"10764065"</span>,<span class="st">"6584508"</span>,<span class="st">"9780995"</span>,<span class="st">"9392015"</span>
,<span class="st">"9654489"</span>,<span class="st">"11036867"</span>,<span class="st">"7533172"</span>,<span class="st">"9825975"</span>,<span class="st">"10205743"</span>,<span class="st">"10645115"</span>,<span class="st">"11171984"</span>,<span class="st">"9578052"</span>,<span class="st">"8464330"</span>,<span class="st">"10044882"</span>,<span class="st">"7480937"</span>,<span class="st">"9094366"</span>,<span class="st">"9413907"</span>,<span class="st">"9781280"</span>,<span class="st">"6785819"</span>,<span class="st">"10652213"</span>,<span class="st">"10826916"</span>,<span class="st">"6349336"</span>,<span class="st">"10740134"</span>,<span class="st">"10701104"</span>
,<span class="st">"7065042"</span>,<span class="st">"10320688"</span>,<span class="st">"8787875"</span>,<span class="st">"8595479"</span>,<span class="st">"9210131"</span>,<span class="st">"10511573"</span>,<span class="st">"7418504"</span>,<span class="st">"7921211"</span>,<span class="st">"7945654"</span>,<span class="st">"8554899"</span>,<span class="st">"8572247"</span>,<span class="st">"8868705"</span>,<span class="st">"9037713"</span>,<span class="st">"9077694"</span>,<span class="st">"9374346"</span>,<span class="st">"9967240"</span>,<span class="st">"6502135"</span>,<span class="st">"6618761"</span>,<span class="st">"6907473"</span>,<span class="st">"7010604"</span>
,<span class="st">"7133930"</span>,<span class="st">"7933990"</span>,<span class="st">"7996539"</span>,<span class="st">"8516117"</span>,<span class="st">"8874771"</span>,<span class="st">"9479426"</span>,<span class="st">"9860283"</span>,<span class="st">"6985942"</span>,<span class="st">"8769608"</span>,<span class="st">"8050281"</span>,<span class="st">"9542830"</span>,<span class="st">"9450919"</span>,<span class="st">"10999318"</span>,<span class="st">"10630509"</span>,<span class="st">"11057243"</span>,<span class="st">"11018995"</span>,<span class="st">"10785115"</span>,<span class="st">"8695079"</span>,<span class="st">"10938619"</span>,<span class="st">"8230493"</span>
,<span class="st">"11157598"</span>,<span class="st">"8707406"</span>,<span class="st">"10986555"</span>,<span class="st">"10681064"</span>,<span class="st">"10367703"</span>,<span class="st">"10931468"</span>,<span class="st">"9407662"</span>,<span class="st">"9065846"</span>,<span class="st">"10749886"</span>,<span class="st">"9769187"</span>,<span class="st">"10102019"</span>,<span class="st">"10289858"</span>,<span class="st">"8244745"</span>,<span class="st">"8694523"</span>,<span class="st">"9152774"</span>,<span class="st">"10652254"</span>,<span class="st">"8990259"</span>,<span class="st">"9514246"</span>,<span class="st">"10595360"</span>,<span class="st">"10021108"</span>
,<span class="st">"11012409"</span>,<span class="st">"11005872"</span>,<span class="st">"9497206"</span>,<span class="st">"10986067"</span>,<span class="st">"10911335"</span>,<span class="st">"10623283"</span>,<span class="st">"10992675"</span>,<span class="st">"9813438"</span>,<span class="st">"10277606"</span>,<span class="st">"9942240"</span>,<span class="st">"10375111"</span>,<span class="st">"9031539"</span>,<span class="st">"6738808"</span>,<span class="st">"7069319"</span>,<span class="st">"7418503"</span>,<span class="st">"8041817"</span>,<span class="st">"8402117"</span>,<span class="st">"8645505"</span>,<span class="st">"9571958"</span>,<span class="st">"10305693"</span>
<span class="op">)</span>

<span class="va">query</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span><span class="st">"patent_number"</span> <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>

<span class="va">pv_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>query<span class="op">=</span><span class="va">query</span>, method<span class="op">=</span><span class="st">"POST"</span>, fields <span class="op">=</span> <span class="va">fields</span>, all_pages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>In the new version of the API we don’t get latitude/longitude back
from the patents endpoint. We need to figure out the unique assignee ids
and make a call to the assignees endpoint for this data.</li>
</ol>
<p>A bit of weirdness from the new version of the API here, we asked for
“assignee_id” as a field paramter but we get back a HATEOAS link named
“assignee” where the assignee_id is the url parameter, the digits at the
end, example: 18448 from <a href="https://search.patentsview.org/api/v1/assignee/18448/" class="uri">https://search.patentsview.org/api/v1/assignee/18448/</a>
(clicking on the link won’t send an API key and will be rejected with a
HTTP 403 Forbidden, there you’ve been warned.)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/">leaflet</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/htmltools">htmltools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span>

<span class="co"># my mom was an English teacher, so below we singularize/pluralize Patents</span>
<span class="co"># or maybe Patents:1 was ok?</span>

<span class="va">data</span> <span class="op">&lt;-</span>
  <span class="va">pv_res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patents</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">assignees_at_grant</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>assignee_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">assignee</span>, <span class="st">"(\\d+)(?=/$)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">assignee_id</span>, <span class="va">organization</span>, <span class="va">patent_number</span>,
           <span class="va">longitude</span>, <span class="va">latitude</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by_all.html">group_by_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"pat"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>num_pats <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">patent_number</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>popup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"&lt;font color='Black'&gt;"</span>,
                          <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlEscape.html">htmlEscape</a></span><span class="op">(</span><span class="va">organization</span><span class="op">)</span>, <span class="st">"&lt;br&gt;&lt;br&gt;Patent"</span>,
                          <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">num_pats</span><span class="op">==</span><span class="fl">1</span>, <span class="st">":"</span>, <span class="st">"s:"</span><span class="op">)</span>, <span class="co"># singular/plural</span>
                          <span class="va">num_pats</span>, <span class="st">"&lt;/font&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter_all.html">filter_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">latitude</span>,<span class="va">longitude</span><span class="op">)</span>,<span class="fu"><a href="https://dplyr.tidyverse.org/reference/all_vars.html">any_vars</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># seeing NA lats and longs</span>

<span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addProviderTiles.html">addProviderTiles</a></span><span class="op">(</span><span class="va">providers</span><span class="op">$</span><span class="va">CartoDB.DarkMatterNoLabels</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addCircleMarkers</a></span><span class="op">(</span>lng <span class="op">=</span> <span class="op">~</span><span class="va">longitude</span>, lat <span class="op">=</span> <span class="op">~</span><span class="va">latitude</span>,
                   popup <span class="op">=</span> <span class="op">~</span><span class="va">popup</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">num_pats</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-9-1.png" alt=""><p class="caption">plot of chunk unnamed-chunk-9</p>
</div>
<ol style="list-style-type: decimal">
<li>Plot the growth of the field’s topics over time</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>

<span class="co"># In the new version of the API, we don't get the title back from the patents endpoint</span>
<span class="co"># we have to call, you guessed it, the cpc_subgroup endpoint now</span>
<span class="va">qry</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">begins</span><span class="op">(</span>cpc_subgroup_id <span class="op">=</span> <span class="st">'H04L63/02'</span><span class="op">)</span>
<span class="va">qry</span>
<span class="co">#&gt; {"_begins":{"cpc_subgroup_id":"H04L63/02"}}</span>

<span class="va">cpc_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>query<span class="op">=</span><span class="va">qry</span>, fields <span class="op">=</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span><span class="st">"cpc_subgroups"</span><span class="op">)</span>, endpoint <span class="op">=</span> <span class="st">"cpc_subgroups"</span><span class="op">)</span>

<span class="co"># More API craziness, in the HATEAS link from the patents endpoint, the separator is </span>
<span class="co"># inexplicably a colon.  In the data that comes back from the cpc_subgroups endpoint, the </span>
<span class="co"># separator is, get this, a slash like it should be.  All that to say that joining </span>
<span class="co"># becomes a bit problematic or an exercise that makes dplyr wonder what we're up to.</span>

<span class="va">data</span> <span class="op">&lt;-</span>
  <span class="va">pv_res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patents</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">cpc_current</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cpc_subgroup <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">cpc_subgroup</span>, <span class="st">"([\\w:]+)(?=/$)"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># unHATEOAS cpc_subgroup, funky colon and all</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cpc_subgroup</span> <span class="op">!=</span> <span class="st">"H04L63:02"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># remove patents categorized into only top-level category of H04L63/02</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cpc_subgroup <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">cpc_subgroup</span>, <span class="st">":"</span>, <span class="st">"/"</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span>  <span class="co"># back to normality, ahead of a join</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">cpc_info</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">cpc_subgroups</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cpc_subgroup"</span><span class="op">=</span><span class="st">"cpc_subgroup_id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># highlighting name inconsistency</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
      title <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"filtering"</span>, <span class="va">.</span><span class="op">$</span><span class="va">cpc_subgroup_title</span>, ignore.case <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">~</span>
          <span class="st">"Filtering policies"</span>,
        <span class="va">.</span><span class="op">$</span><span class="va">cpc_subgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"H04L63/0209"</span>, <span class="st">"H04L63/0218"</span><span class="op">)</span> <span class="op">~</span>  
          <span class="st">"Architectural arrangements"</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Firewall traversal"</span>, <span class="va">.</span><span class="op">$</span><span class="va">cpc_subgroup_title</span>, ignore.case <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">~</span>
          <span class="st">"Firewall traversal"</span>,
        <span class="cn">TRUE</span> <span class="op">~</span>
          <span class="va">.</span><span class="op">$</span><span class="va">cpc_subgroup_title</span>
      <span class="op">)</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">".*(?=-)-"</span>, <span class="st">""</span>, <span class="va">title</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">title</span>, <span class="va">patent_year</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Here the line graph looks a bit anemic since our data set was only 300 patents</span>
<span class="co"># Also, we're getting this Warning message:</span>
<span class="co"># Removed 41 rows containing non-finite values (stat_smooth).</span>
<span class="co"># the y scale was limits = c(0, 700))</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">patent_year</span>, y <span class="op">=</span> <span class="va">n</span>, colour <span class="op">=</span> <span class="va">title</span><span class="op">)</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">"\nPublication year"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2007</span>, <span class="fl">2016</span><span class="op">)</span>,
                     breaks <span class="op">=</span> <span class="fl">2007</span><span class="op">:</span><span class="fl">2016</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Patents\n"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span><span class="st">""</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Set2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># theme inspired by https://hrbrmstr.github.io/hrbrthemes/</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span>
<span class="co">#&gt; Warning: Removed 41 rows containing non-finite values (stat_smooth).</span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-10-1.png" alt=""><p class="caption">plot of chunk unnamed-chunk-10</p>
</div>
<p>Somehow the ggplot winds up in the html properly. In the top
assignees vignette, the hchart only shows a little bit of IBM’s
patents.</p>
<p>Man, I’m thinking I’ll make good money helping people convert their R
scripts!</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christopher Baker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
