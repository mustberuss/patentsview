<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="patentsview">
<title>Accessing patent data with the patentsview package • patentsview</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Accessing patent data with the patentsview package">
<meta property="og:description" content="patentsview">
<meta property="og:image" content="https://mustberuss.github.io/patentsview/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">patentsview</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--api-changes">
    <span class="fa fa-flag"></span>
     
    API Changes
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--api-changes">
    <a class="dropdown-item" href="../articles/api-changes.html">
      <span class="fa fa-exclamation"></span>
       
      2024 API Changes
    </a>
    <a class="dropdown-item" href="../articles/converting-an-existing-script.html">
      <span class="fa fa-sync"></span>
       
      Converting an Existing Script
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/getting-started.html">
    <span class="fa fa-play"></span>
     
    Getting started
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/writing-queries.html">
    <span class="fa fa-pencil"></span>
     
    Writing queries
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--applications">
    <span class="fa fa-bar-chart"></span>
     
    Applications
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--applications">
    <a class="dropdown-item" href="../articles/examples.html">
      <span class="fa fa-code"></span>
       
      Examples
    </a>
    <a class="dropdown-item" href="../articles/top-assignees.html">
      <span class="fa fa-university"></span>
       
      Top assignees
    </a>
    <a class="dropdown-item" href="../articles/citation-networks.html">
      <span class="fa fa-long-arrow-left"></span>
       
      Citation networks
    </a>
    <a class="dropdown-item" href="../articles/ropensci_blog_post.html">
      <span class="fa fa-bullhorn"></span>
       
      ropensci announcement
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/patentsview/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Accessing patent data with the patentsview package</h1>
                        <h4 data-toc-skip class="author">Chris
Baker</h4>
                                    <h4 data-toc-skip class="author">Russ
Allen</h4>
                        
            <h4 data-toc-skip class="date">2024-09-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/HEAD/vignettes/ropensci_blog_post.Rmd" class="external-link"><code>vignettes/ropensci_blog_post.Rmd</code></a></small>
      <div class="d-none name"><code>ropensci_blog_post.Rmd</code></div>
    </div>

    
    
<blockquote>
<p>This is Chris’ ropensci blog post from 2017-09-12 that announced the
creation of the original patentsview package, edited by Russ to work
with the new version of the R package and API. The original post is <a href="https://ropensci.org/blog/2017/09/19/patentsview/" class="external-link">here</a>.
Something to note when comparing the original post to this one, the
total_hits returned by the original version of the API was capped at
100,000, now it’s seemingly unbounded. Also, note that some fields used
in examples in the original post are no longer available from the new
version of the API, as mentioned below.</p>
</blockquote>
<div class="section level2">
<h2 id="why-care-about-patents">Why care about patents?<a class="anchor" aria-label="anchor" href="#why-care-about-patents"></a>
</h2>
<p><strong>1. Patents play a critical role in incentivizing innovation,
without which we wouldn’t have much of the technology we rely on
everyday</strong></p>
<p>What does your iPhone, Google’s PageRank algorithm, and a butter
substitute called Smart Balance all have in common?</p>
<p><span>
<!-- These are open source images taken from: https://pixabay.com/ -->
<img src="../reference/figures/2017-09-12-patentsview-iphone.png" width="15%"><img src="../reference/figures/2017-09-12-patentsview-google.jpg" width="25%"><img src="../reference/figures/2017-09-12-patentsview-butter.png" width="25%"></span></p>
<p>…They all probably wouldn’t be here if not for patents. A patent
provides its owner with the ability to make money off of something that
they invented, without having to worry about someone else copying their
technology. Think Apple would spend millions of dollars developing the
iPhone if Samsung could just come along and <a href="http://www.reuters.com/article/us-apple-samsung-elec-appeal-idUSKCN1271LF" class="external-link">rip
it off</a>? Probably not.</p>
<p><strong>2. Patents offer a great opportunity for data
analysis</strong></p>
<p>There are two primary reasons for this:</p>
<ul>
<li>
<strong>Patent data is public</strong>. In return for the exclusive
right to profit off an invention, an individual/company has to publicly
disclose the details of their invention to the rest of the world. <a href="https://ppubs.uspto.gov/pubwebapp/external.html?q=dog.ttl.&amp;db=USPAT&amp;type=queryString" class="external-link">Examples
of those details</a> include the patent’s title, abstract, technology
classification, assigned organizations, etc.</li>
<li>
<strong>Patent data can answer questions that people care
about</strong>. Companies (especially big ones like IBM and Google) have
a vested interest in extracting insights from patents, and spend a lot
of time/resources trying figure out how to best manage their
intellectual property (IP) rights. They’re plagued by questions like
“who should I sell my underperforming patents to,” “which technology
areas are open to new innovations,” “what’s going to be the next big
thing in the world of buttery spreads,” etc. Patents offer a way to
provide data-driven answers to these questions.</li>
</ul>
<p>Combined, these two things make patents a prime target for data
analysis. However, until recently it was hard to get at the data inside
these documents. One had to either collect it manually using the
official <a href="https://en.wikipedia.org/wiki/United_States_Patent_and_Trademark_Office" class="external-link">United
States Patent and Trademark Office</a> (USPTO) <a href="https://www.uspto.gov/patents/search/patent-public-search" class="external-link">search
engine</a>, or figure out a way to download, parse, and model huge XML
data dumps. Enter PatentsView.</p>
</div>
<div class="section level2">
<h2 id="patentsview-and-the-patentsview-package">PatentsView and the <code>patentsview</code> package<a class="anchor" aria-label="anchor" href="#patentsview-and-the-patentsview-package"></a>
</h2>
<p><a href="https://datatool.patentsview.org/#viz/relationships" class="external-link">PatentsView</a>
is one of USPTO’s new initiatives intended to increase the usability and
value of patent data. One feature of this project is a publicly
accessible API that makes it easy to programmatically interact with the
data. A few of the reasons why I like the API (and PatentsView more
generally):</p>
<ul>
<li>An API key is now required (request one <a href="https://patentsview.org/apis/keyrequest" class="external-link">here</a>) and throttling
is imposed (handled by the new version of the R package) at 45 requests
per minute.</li>
<li>The project offers <a href="https://patentsview.org/download/data-download-tables" class="external-link">bulk
downloads of patent data</a> on their website (in a flat file format),
for those who want to be closest to the data.</li>
<li>Both the API and the bulk download data contain disambiguated
entities such as inventors, assignees, organizations, etc. In other
words, the API will tell you whether it thinks that John Smith on patent
X is the same person as John Smith on patent Y.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;This is both good and bad, as there are errors in the
disambiguation. The algorithm that is responsible for the disambiguation
was created by the winner of the &lt;a href="http://www.patentsview.org/workshop/" class="external-link"&gt;PatentsView Inventor
Disambiguation Technical Workshop&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a>
</li>
</ul>
<p>The <code>patentsview</code> R package is a wrapper around the
PatentsView API. It contains a function that acts as a client to the API
(<code><a href="../reference/search_pv.html">search_pv()</a></code>) as well as several supporting functions. Full
documentation of the package can be found on its <a href="https://ropensci.github.io/patentsview/index.html" class="external-link">website</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the stable version of <code>patentsview</code> from
r-universe:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  patentsview <span class="op">=</span> <span class="st">"https://mustberuss.r-universe.dev/"</span>,</span>
<span>  CRAN <span class="op">=</span> <span class="st">"https://cloud.r-project.org"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"patentsview"</span><span class="op">)</span></span></code></pre></div>
<p>Or from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span>   <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mustberuss/patentsview@api-redesign"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>The package has one main function, <code><a href="../reference/search_pv.html">search_pv()</a></code>, that
makes it easy to send requests to the API. There are two parameters to
<code><a href="../reference/search_pv.html">search_pv()</a></code> that you’re going to want to think about just
about every time you call it - <code>query</code> and
<code>fields</code>. You tell the API how you want to filter the patent
data with <code>query</code>, and which fields you want to retrieve with
<code>fields</code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;These two parameters end up getting translated into a
Elasticsearch query by the API’s server, which then gets sent to a
back-end database. &lt;code&gt;query&lt;/code&gt; and &lt;code&gt;fields&lt;/code&gt; are used
to create the query’s &lt;code&gt;WHERE&lt;/code&gt; and &lt;code&gt;SELECT&lt;/code&gt;
clauses, respectively.&lt;/p&gt;"><sup>2</sup></a></p>
<div class="section level3">
<h3 id="query">
<code>query</code><a class="anchor" aria-label="anchor" href="#query"></a>
</h3>
<p>Your query has to use the <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#api-query-language" class="external-link">PatentsView
query language</a>, which is a JSON-based syntax that is similar to the
one used by Lucene. You can write the query directly and pass it as a
string to <code><a href="../reference/search_pv.html">search_pv()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mustberuss.github.io/patentsview/index.html">patentsview</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">qry_1</span> <span class="op">&lt;-</span> <span class="st">'{"_gt":{"patent_year":2014}}'</span></span>
<span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>query <span class="op">=</span> <span class="va">qry_1</span>, fields <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># This will retrieve a default set of fields</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id   : chr [1:1000] "10000000" ...</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr [1:1000] "Coherent LADAR using intra-pixel quadrature"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date : chr [1:1000] "2018-06-19" ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 3,401,344</span></span></code></pre></div>
<p>…Or you can use the domain specific language (DSL) provided in the
<code>patentsview</code> package to help you write the query:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qry_2</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span>patent_year <span class="op">=</span> <span class="fl">2014</span><span class="op">)</span> <span class="co"># All DSL functions are in the qry_funs list</span></span>
<span><span class="va">qry_2</span> <span class="co"># qry_2 is the same as qry_1</span></span>
<span><span class="co">#&gt; {"_gt":{"patent_year":2014}}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>query <span class="op">=</span> <span class="va">qry_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id   : chr [1:1000] "10000000" ...</span></span>
<span><span class="co">#&gt;   ..$ patent_title: chr [1:1000] "Coherent LADAR using intra-pixel quadrature"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date : chr [1:1000] "2018-06-19" ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 3,401,344</span></span></code></pre></div>
<p><code>qry_1</code> and <code>qry_2</code> will result in the same
HTTP call to the API. Both queries search for patents in USPTO that were
published after 2014. There are three gotchas to look out for when
writing a query:</p>
<ol style="list-style-type: decimal">
<li>
<strong>All Fields are now queryable.</strong> The API has 23
endpoints (the default endpoint is “patent”), and each endpoint has its
own set of fields that you can filter on.</li>
<li>
<strong>Correct data type for field.</strong> If you’re filtering on
a field in your query, you have to make sure that the value you are
filtering on is consistent with the field’s data type. For example,
<code>patent_year</code> has type “integer,” so if you pass 2014 as a
string then you’re going to get an error
(<code>patent_year = 2014</code> is good,
<code>patent_year = "2014"</code> is no good). You can find a field’s
data type in the <code>fieldsdf</code> data frame.</li>
<li>
<strong>Comparison function works with field’s data type.</strong>
The comparison function(s) that you use (e.g., the greater-than function
shown above, <code>qry_funs$gt()</code>) must be consistent with the
field’s data type. For example, you can’t use the “contains” function on
fields of type “integer”
(<code>qry_funs$contains(patent_year = 2014)</code> will throw an
error). See <code><a href="../reference/qry_funs.html">?qry_funs</a></code> for more details.</li>
</ol>
<p>In short, use the <code>fieldsdf</code> data frame when you write a
query and you should be fine. Check out the <a href="writing-queries.html">writing queries vignette</a> for more
details.</p>
</div>
<div class="section level3">
<h3 id="fields">
<code>fields</code><a class="anchor" aria-label="anchor" href="#fields"></a>
</h3>
<p>Up until now we have been using the default value for
<code>fields</code>. This results in the API giving us some small set of
default fields. Let’s see about retrieving some more fields:</p>
<p>With the original verison of the API, we requested
patent_average_processing_time and inventor_total_num_patents. These
fields are no longer available from the patent endpoint.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span>patent_year <span class="op">=</span> <span class="fl">2014</span><span class="op">)</span>,</span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_abstract"</span>, <span class="st">"inventors.inventor_name_first"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_abstract: chr [1:1000] "A frequency modulated (coherent) laser d"..</span></span>
<span><span class="co">#&gt;   ..$ inventors      :List of 1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 3,401,344</span></span></code></pre></div>
<p>The fields that you can retrieve depends on the endpoint that you are
hitting. We’ve been using the “patent” endpoint thus far, so all of
these are retrievable:
<code>fieldsdf[fieldsdf$endpoint == "patent", "field"]</code>. You can
also use <code><a href="../reference/get_fields.html">get_fields()</a></code> to list the retrievable fields for a
given endpoint, optionally limited to specific groups of nested or top
level (the “” in groups) fields</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span>patent_year <span class="op">=</span> <span class="fl">2014</span><span class="op">)</span>,</span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patent"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"inventors"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; #### A list with a single data frame (with list column(s) inside) on patents level:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ patents:'data.frame': 1000 obs. of  19 variables:</span></span>
<span><span class="co">#&gt;   ..$ patent_id                                                   : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_title                                                : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_type                                                 : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_date                                                 : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_year                                                 : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_abstract                                             : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_cpc_current_group_average_patent_processing_days     : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_detail_desc_length                                   : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_earliest_application_date                            : chr [1:10"..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_foreign_documents_cited                          : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_times_cited_by_us_patents                        : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_total_documents_cited                            : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_us_applications_cited                            : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_num_us_patents_cited                                 : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_processing_days                                      : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_term_extension                                       : int [1:100..</span></span>
<span><span class="co">#&gt;   ..$ gov_interest_statement                                      : chr [1:100..</span></span>
<span><span class="co">#&gt;   ..$ patent_uspc_current_mainclass_average_patent_processing_days: logi [1:10..</span></span>
<span><span class="co">#&gt;   ..$ inventors                                                   :List of 1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $query_results</span></span>
<span><span class="co">#&gt; #### Distinct entity counts across all downloadable pages of output:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total_hits = 3,401,344</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Let’s look at a quick example of pulling and analyzing patent data.
We’ll look at patents from the last ten years that are classified below
the <a href="https://worldwide.espacenet.com/classification#!/CPC=H04L63/02" class="external-link">H04L63/00
CPC code</a>. Patents in this area relate to “network architectures or
network communication protocols for separating internal from external
traffic.”<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;There is a slightly more in-depth definition that says
that these are patents “related to the (logical) separation of
traffic/(sub-) networks to achieve protection.”&lt;/p&gt;"><sup>3</sup></a> CPC codes offer a quick and dirty way to
find patents of interest, though getting a sense of their hierarchy can
be tricky.</p>
<ol style="list-style-type: decimal">
<li>Download the data</li>
</ol>
<p>The original blog’s query is not possible in the new version of the
API, assignee_longitude and assignee_latitude are no longer returned by
the patent endpoint. Here we’ll use a different endpoint and a slightly
different query to get latitudes and longitudes to plot. Now we’ll query
the assignee endpoint for non-empty assignee_organization name, where
their assignee_individual_name_first and assignee_individual_name_last
would be empty (query where the assignee is an entity, not an
individual). The sort will be by assignee_num_patents descending so
we’ll get a list of the most proflic assignee_organizations</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mustberuss.github.io/patentsview/index.html">patentsview</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span> <span class="co"># with_qfuns is basically just: with(qry_funs, ...)</span></span>
<span>  <span class="fu">neq</span><span class="op">(</span><span class="st">"assignee_organization"</span> <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a list of fields:</span></span>
<span><span class="co"># We request the fields we will use below rather than requesting them all and </span></span>
<span><span class="co"># then filtering to get just the ones we want</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"assignee_id"</span>, <span class="st">"assignee_organization"</span>, <span class="st">"assignee_num_patents"</span>,</span>
<span>   <span class="st">"assignee_lastknown_latitude"</span>, <span class="st">"assignee_lastknown_longitude"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Send HTTP request to API's server:</span></span>
<span><span class="va">pv_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"assignee"</span>, query <span class="op">=</span> <span class="va">query</span>, fields <span class="op">=</span> <span class="va">fields</span>, </span>
<span>   sort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"assignee_num_patents"</span> <span class="op">=</span> <span class="st">"desc"</span><span class="op">)</span>, all_pages <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>See where the assignees are coming from (geographically)</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/htmltools" class="external-link">htmltools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># My mom was an English teacher, so below we singularize/pluralize Patents</span></span>
<span><span class="co"># or maybe Patents:1 was ok?  Here, because of the sort, it will be unlikely</span></span>
<span><span class="co"># that there will be a single patent in our results.</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">pv_res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">assignees</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>popup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">"&lt;font color='Black'&gt;"</span>,</span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/htmlEscape.html" class="external-link">htmlEscape</a></span><span class="op">(</span><span class="va">assignee_organization</span><span class="op">)</span>, <span class="st">"&lt;br&gt;&lt;br&gt;Patent"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">assignee_num_patents</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">":"</span>, <span class="st">"s:"</span><span class="op">)</span>, <span class="co"># singular/plural</span></span>
<span>    <span class="va">assignee_num_patents</span>, <span class="st">"&lt;/font&gt;"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter_all.html" class="external-link">filter_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">assignee_lastknown_latitude</span>, <span class="va">assignee_lastknown_longitude</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/all_vars.html" class="external-link">any_vars</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># seeing NA lats and longs</span></span>
<span></span>
<span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addProviderTiles.html" class="external-link">addProviderTiles</a></span><span class="op">(</span><span class="va">providers</span><span class="op">$</span><span class="va">CartoDB.DarkMatterNoLabels</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addCircleMarkers</a></span><span class="op">(</span></span>
<span>    lng <span class="op">=</span> <span class="op">~</span><span class="va">assignee_lastknown_longitude</span>, lat <span class="op">=</span> <span class="op">~</span><span class="va">assignee_lastknown_latitude</span>,</span>
<span>    popup <span class="op">=</span> <span class="op">~</span><span class="va">popup</span>, radius<span class="op">=</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"yellow"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="figure/blogleaflet-1.png"></p>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li>Plot the growth of the field’s topics over time</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Here we issue the original post's query, rewritten for the new version of the API</span></span>
<span><span class="co"># (note the field name change as well as it being nested inside the cpc_current object)</span></span>
<span><span class="co"># Oh, and we bumped the patent_year to give us data for the last ten years</span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span> <span class="co"># with_qfuns is basically just: with(qry_funs, ...)</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">and</a></span><span class="op">(</span></span>
<span>    <span class="fu">begins</span><span class="op">(</span>cpc_current.cpc_group_id <span class="op">=</span> <span class="st">"H04L63/02"</span><span class="op">)</span>,</span>
<span>    <span class="fu">gte</span><span class="op">(</span>patent_year <span class="op">=</span> <span class="fl">2014</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a list of fields:</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="st">"patent_year"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"patent"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"assignees"</span>, <span class="st">"cpc_current"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pv_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>query <span class="op">=</span> <span class="va">query</span>, fields <span class="op">=</span> <span class="va">fields</span>, all_pages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># In the new version of the API, we don't get the CPC title back from the patent endpoint</span></span>
<span><span class="co"># we have to call, you guessed it, the cpc_group endpoint now</span></span>
<span><span class="va">qry</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">begins</span><span class="op">(</span>cpc_group_id <span class="op">=</span> <span class="st">"H04L63/02"</span><span class="op">)</span></span>
<span><span class="va">qry</span></span>
<span><span class="co">#&gt; {"_begins":{"cpc_group_id":"H04L63/02"}}</span></span>
<span></span>
<span><span class="va">cpc_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span>query <span class="op">=</span> <span class="va">qry</span>, fields <span class="op">=</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span><span class="st">"cpc_group"</span><span class="op">)</span>, endpoint <span class="op">=</span> <span class="st">"cpc_group"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># More API craziness, in the HATEOAS link from the patent endpoint, the separator is</span></span>
<span><span class="co"># inexplicably a colon.  In the data that comes back from the cpc_group endpoint, the</span></span>
<span><span class="co"># separator is, get this, a slash like it should be.  All that to say that joining</span></span>
<span><span class="co"># becomes a bit problematic or an exercise that makes dplyr wonder what we're up to.</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">pv_res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patents</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">cpc_current</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cpc_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*/([\\w:]+)/$"</span>, <span class="st">"\\1"</span>, <span class="va">cpc_group</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># unHATEOAS cpc_group, funky colon and all</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cpc_group</span> <span class="op">!=</span> <span class="st">"H04L63:02"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># remove patents categorized into only top-level category of H04L63/02</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cpc_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">":"</span>, <span class="st">"/"</span>, <span class="va">cpc_group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># back to normality, ahead of a join</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">cpc_info</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">cpc_groups</span>, by <span class="op">=</span> <span class="st">"cpc_group_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"filtering"</span>, <span class="va">.</span><span class="op">$</span><span class="va">cpc_group_title</span>, ignore.case <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">~</span></span>
<span>        <span class="st">"Filtering policies"</span>,</span>
<span>      <span class="va">.</span><span class="op">$</span><span class="va">cpc_group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H04L63/0209"</span>, <span class="st">"H04L63/0218"</span><span class="op">)</span> <span class="op">~</span></span>
<span>        <span class="st">"Architectural arrangements"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Firewall traversal"</span>, <span class="va">.</span><span class="op">$</span><span class="va">cpc_group_title</span>, ignore.case <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">~</span></span>
<span>        <span class="st">"Firewall traversal"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span></span>
<span>        <span class="va">.</span><span class="op">$</span><span class="va">cpc_group_title</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*(?=-)-"</span>, <span class="st">""</span>, <span class="va">title</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">title</span>, <span class="va">patent_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">max_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">patent_year</span><span class="op">)</span></span>
<span><span class="va">y_limit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">n</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">100</span><span class="op">)</span> <span class="co"># even hundred past the max</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">patent_year</span>, y <span class="op">=</span> <span class="va">n</span>, colour <span class="op">=</span> <span class="va">title</span><span class="op">)</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"\nGrant year"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2014</span>, <span class="va">max_year</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fl">2014</span><span class="op">:</span><span class="va">max_year</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Patents\n"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">y_limit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span><span class="st">""</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Set2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># theme inspired by https://hrbrmstr.github.io/hrbrthemes/</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/blogplot-1.png"></p>
</div>
<div class="section level2">
<h2 id="learning-more">Learning more<a class="anchor" aria-label="anchor" href="#learning-more"></a>
</h2>
<p>For analysis examples that go into a little more depth, check out the
<a href="citation-networks.html">data applications vignettes</a> on the
package’s website. If you’re just interested in
<code><a href="../reference/search_pv.html">search_pv()</a></code>, there are <a href="examples.html">examples</a>
on the site for that as well. To contribute to the package or report an
issue, check out the <a href="https://github.com/ropensci/patentsview/issues" class="external-link">issues page on
GitHub</a>.</p>
</div>
<div class="section level2">
<h2 id="acknowledgments-from-the-original-blog-post">Acknowledgments from the Original Blog Post<a class="anchor" aria-label="anchor" href="#acknowledgments-from-the-original-blog-post"></a>
</h2>
<p>I’d like to thank the package’s two reviewers, <a href="https://github.com/poldham" class="external-link">Paul Oldham</a> and <a href="http://blog.haunschmid.name/" class="external-link">Verena Haunschmid</a>, for taking
the time to review the package and providing helpful feedback. I’d also
like to thank <a href="http://www.masalmon.eu/" class="external-link">Maëlle Salmon</a> for
shepherding the package along the rOpenSci review process, as well <a href="https://scottchamberlain.info/" class="external-link">Scott Chamberlain</a> and <a href="https://twitter.com/stefaniebutland" class="external-link">Stefanie Butland</a> for
their miscellaneous help.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Baker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
