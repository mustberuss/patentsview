<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="patentsview">
<title>Understanding the API • patentsview</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Understanding the API">
<meta property="og:description" content="patentsview">
<meta property="og:image" content="https://mustberuss.github.io/patentsview/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">patentsview</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--api-changes">
    <span class="fa fa-flag"></span>
     
    API Changes
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--api-changes">
    <a class="dropdown-item" href="../articles/api-changes.html">
      <span class="fa fa-exclamation"></span>
       
      2024 API Changes
    </a>
    <a class="dropdown-item" href="../articles/converting-an-existing-script.html">
      <span class="fa fa-sync"></span>
       
      Converting an Existing Script
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/getting-started.html">
    <span class="fa fa-play"></span>
     
    Getting started
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/writing-queries.html">
    <span class="fa fa-pencil"></span>
     
    Writing queries
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--applications">
    <span class="fa fa-bar-chart"></span>
     
    Applications
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--applications">
    <a class="dropdown-item" href="../articles/examples.html">
      <span class="fa fa-code"></span>
       
      Examples
    </a>
    <a class="dropdown-item" href="../articles/top-assignees.html">
      <span class="fa fa-university"></span>
       
      Top assignees
    </a>
    <a class="dropdown-item" href="../articles/citation-networks.html">
      <span class="fa fa-long-arrow-left"></span>
       
      Citation networks
    </a>
    <a class="dropdown-item" href="../articles/ropensci_blog_post.html">
      <span class="fa fa-bullhorn"></span>
       
      ropensci announcement
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/patentsview/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Understanding the API</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/HEAD/vignettes/understanding-the-api.Rmd" class="external-link"><code>vignettes/understanding-the-api.Rmd</code></a></small>
      <div class="d-none name"><code>understanding-the-api.Rmd</code></div>
    </div>

    
    
<p>Oh, the interesting things you’ll learn when you take the time to
read the API documentation! Here are gems gleaned from a <a href="https://github.com/PatentsView/PatentsView-Code-Snippets/blob/master/07_PatentSearch_API_demo/PV%20PatentSearch%20API%20tutorial.ipynb" class="external-link">jupyter
notebook</a> in PatentsView’s PatentsView-Code-Snippets repo.</p>
<div class="section level2">
<h2 id="fields-shorthand">Fields Shorthand<a class="anchor" aria-label="anchor" href="#fields-shorthand"></a>
</h2>
<p>The notebook starts out fairly fluffy but things really get
interesting really quickly. See this under “constructing your query”, I
don’t remember seeing this anywhere else:</p>
<blockquote>
<p>Some endpoints contain groups of fields representing related entities
connected to one of that endpoint’s primary entity type; for example,
the patent endpoint contains a field “inventors”, which contains
information on all inventors associated with any given patent. <em>The
fields for related entities can be requested in the API request’s fields
parameter as a group by using the group name in the fields
parameter</em>, or individually by specifying the required field as
“{entity_type}.{subfield}”.</p>
</blockquote>
<p>Mind blown, so we can, for example, request all the nested
application fields from the patent endpoint by simply requesting
“application” in the fields list.</p>
<p>The new version of the R package will let its users leverage this
same “feature”. (Purists will probably frown upon using it, as they
would with a select * in SQL. It can be helpful to see exactly what
fields the API can return, should the documentation be lagging.)</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mustberuss.github.io/patentsview/index.html">patentsview</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pat_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>patent_id <span class="op">=</span> <span class="st">"10568228"</span><span class="op">)</span>, fields<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"application"</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"POST"</span><span class="op">)</span></span>
<span><span class="va">pat_res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patent</span><span class="op">$</span><span class="va">application</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;   application_id application_type filing_date series_code rule_47_flag</span></span>
<span><span class="co">#&gt; 1      15/995745               15  2018-06-01          15        FALSE</span></span>
<span><span class="co">#&gt;   filing_type</span></span>
<span><span class="co">#&gt; 1          15</span></span>
<span><span class="va">pat_res</span><span class="op">$</span><span class="va">request</span></span>
<span><span class="co">#&gt; #### An HTTP request where:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: POST</span></span>
<span><span class="co">#&gt; URL: https://search.patentsview.org/api/v1/patent/</span></span></code></pre></div>
<p>The results should be the same if we used
<code>fields=get_fields("patent", groups=c("application"))</code>. The
difference is that in the case above, it’s the API deciding what fields
to return while in the get_fields() case, we parsed the <a href="https://search.patentsview.org/static/openapi.json" class="external-link">API’s OpenAPI
object</a> when building the R package to determine what fields can be
requested. The results could be different if the API’s actual return is
not in sync with the API’s OpenAPI object. Here we see that the requests
are different but the results are the same (we used POSTs so the
requests are easier to read since they don’t need to be urlencoded):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fields.html">get_fields</a></span><span class="op">(</span><span class="st">"patent"</span>, groups<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"application"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">app_fields</span></span>
<span><span class="co">#&gt; [1] "application.application_id"   "application.application_type"</span></span>
<span><span class="co">#&gt; [3] "application.filing_date"      "application.filing_type"     </span></span>
<span><span class="co">#&gt; [5] "application.rule_47_flag"     "application.series_code"</span></span>
<span></span>
<span><span class="va">pat_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>patent_id <span class="op">=</span> <span class="st">"10568228"</span><span class="op">)</span>, fields<span class="op">=</span><span class="va">app_fields</span>, method<span class="op">=</span><span class="st">"POST"</span><span class="op">)</span></span>
<span><span class="va">pat_res</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">patent</span><span class="op">$</span><span class="va">application</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;   application_id application_type filing_date series_code rule_47_flag</span></span>
<span><span class="co">#&gt; 1      15/995745               15  2018-06-01          15        FALSE</span></span>
<span><span class="co">#&gt;   filing_type</span></span>
<span><span class="co">#&gt; 1          15</span></span>
<span></span>
<span><span class="co"># the request here and the one above differ, but the results were the same!</span></span>
<span><span class="va">pat_res</span><span class="op">$</span><span class="va">request</span></span>
<span><span class="co">#&gt; #### An HTTP request where:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: POST</span></span>
<span><span class="co">#&gt; URL: https://search.patentsview.org/api/v1/patent/</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="unexpected-results">Unexpected Results<a class="anchor" aria-label="anchor" href="#unexpected-results"></a>
</h2>
<p>Then, as if that wasn’t enough, some non-obvious behavior appears
under the second bullet point under the “Queries using related entity
fields” header:</p>
<blockquote>
<p>When applying multiple conditions to related-entity fields, a central
entity record will be returned if any combination of its related
entities satisfy those conditions.</p>
</blockquote>
<p>In their example, they use George Washington as an inventor.
Humorously, there are modern inventors with that name! Abraham Lincoln
is also used as an inventor. Good ol’ Abe is the only US president to
receive a <a href="https://ppubs.uspto.gov/pubwebapp/external.html?db=USPAT&amp;type=ids&amp;q=(0006469).pn." class="external-link">patent</a>
but it’s too early to be in the patentsview database and there are no
modern Abraham Lincolns to be found as inventors.</p>
<p>To demonstrate the API’s not-exactly-intuitive behavior, we’ll keep
George as an inventor but substitute Thomas Jefferson for Abe, as there
are inventors going by that famous name, though they aren’t on nickels
or two dollar bills in the US.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">patents_query</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>    <span class="fu">or</span><span class="op">(</span></span>
<span>      <span class="fu">and</span><span class="op">(</span></span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventors.inventor_name_first <span class="op">=</span> <span class="st">"George"</span><span class="op">)</span>,</span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Washington"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu">and</span><span class="op">(</span></span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventors.inventor_name_first <span class="op">=</span> <span class="st">"Thomas"</span><span class="op">)</span>,</span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Jefferson"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">patent_fields</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="st">"inventors.inventor_name_first"</span>, <span class="st">"inventors.inventor_name_last"</span><span class="op">)</span></span>
<span><span class="va">pat_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">patents_query</span>, fields<span class="op">=</span><span class="va">patent_fields</span>, endpoint<span class="op">=</span><span class="st">"patent"</span><span class="op">)</span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unnest_pv_data.html">unnest_pv_data</a></span><span class="op">(</span><span class="va">pat_res</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We got back all the inventors on the patents that met our search criteria.  We'll filter out</span></span>
<span><span class="co"># the inventors that didn't strictly meet our criteria (they came along for the ride with</span></span>
<span><span class="co"># the ones that met our criteria), we want the noted behavior to be clear.</span></span>
<span></span>
<span><span class="va">display_inventors</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">dl</span><span class="op">$</span><span class="va">inventors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^(George|Thomas)"</span>, <span class="va">inventor_name_first</span> <span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^(Washington|Jefferson)"</span>, <span class="va">inventor_name_last</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">patent_id</span><span class="op">)</span>, <span class="va">patent_id</span><span class="op">)</span>  <span class="co"># numeric sort on a string field</span></span>
<span></span>
<span><span class="va">display_inventors</span></span>
<span><span class="co">#&gt;    patent_id inventor_name_first inventor_name_last</span></span>
<span><span class="co">#&gt; 1    4078607              Thomas          Jefferson</span></span>
<span><span class="co">#&gt; 2    4104193              Thomas          Jefferson</span></span>
<span><span class="co">#&gt; 3    5643452              George         Washington</span></span>
<span><span class="co">#&gt; 4    5645778              George         Washington</span></span>
<span><span class="co">#&gt; 5    5736046              George         Washington</span></span>
<span><span class="co">#&gt; 6    5897817              George         Washington</span></span>
<span><span class="co">#&gt; 7    5914971           George E.         Burke, Jr.</span></span>
<span><span class="co">#&gt; 8    5914971           Rodney B.         Washington</span></span>
<span><span class="co">#&gt; 9    6218441              George         Washington</span></span>
<span><span class="co">#&gt; 10   6881337              George         Washington</span></span>
<span><span class="co">#&gt; 11   6905071              Thomas           Amundsen</span></span>
<span><span class="co">#&gt; 12   6905071              George              Kolis</span></span>
<span><span class="co">#&gt; 13   6905071             Matthew          Jefferson</span></span>
<span><span class="co">#&gt; 14   7144505              George         Washington</span></span>
<span><span class="co">#&gt; 15   7598629           George E.         Burke, Jr.</span></span>
<span><span class="co">#&gt; 16   7598629           Rodney B.         Washington</span></span>
<span><span class="co">#&gt; 17   7971908              Thomas              Tilly</span></span>
<span><span class="co">#&gt; 18   7971908           Thomas M.           DiMambro</span></span>
<span><span class="co">#&gt; 19   7971908           Alfred A.          Jefferson</span></span>
<span><span class="co">#&gt; 20   8347213           Thomas M.            Clifton</span></span>
<span><span class="co">#&gt; 21   8347213          Bradley C.          Jefferson</span></span>
<span><span class="co">#&gt; 22   8717367           Thomas M.            Clifton</span></span>
<span><span class="co">#&gt; 23   8717367          Bradley C.          Jefferson</span></span>
<span><span class="co">#&gt; 24  10180440          Stanley T.          Jefferson</span></span>
<span><span class="co">#&gt; 25  10180440              Thomas                FAY</span></span>
<span><span class="co">#&gt; 26  10374815           Thomas J.             Bonola</span></span>
<span><span class="co">#&gt; 27  10374815             Lorri L          Jefferson</span></span>
<span><span class="co">#&gt; 28  10568228      George Elliott         Washington</span></span>
<span><span class="co">#&gt; 29  10664808                Joel         Washington</span></span>
<span><span class="co">#&gt; 30  11032709           Thomas J.             Bonola</span></span>
<span><span class="co">#&gt; 31  11032709             Lorri L          Jefferson</span></span></code></pre></div>
<p>Now we’ll hit the inventor endpoint with a similar query, as the
jupyter notebook suggests.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">inventors_query</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>    <span class="fu">or</span><span class="op">(</span></span>
<span>      <span class="fu">and</span><span class="op">(</span></span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventor_name_first <span class="op">=</span> <span class="st">"George"</span><span class="op">)</span>,</span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventor_name_last <span class="op">=</span> <span class="st">"Washington"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu">and</span><span class="op">(</span></span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventor_name_first <span class="op">=</span> <span class="st">"Thomas"</span><span class="op">)</span>,</span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventor_name_last <span class="op">=</span> <span class="st">"Jefferson"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">inventor_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inventor_id"</span>,<span class="st">"inventor_name_first"</span>,<span class="st">"inventor_name_last"</span><span class="op">)</span></span>
<span><span class="va">inventor_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">inventors_query</span>, fields<span class="op">=</span><span class="va">inventor_fields</span>, endpoint<span class="op">=</span><span class="st">"inventor"</span><span class="op">)</span></span>
<span><span class="va">dl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unnest_pv_data.html">unnest_pv_data</a></span><span class="op">(</span><span class="va">inventor_res</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">actual_inventors</span> <span class="op">&lt;-</span></span>
<span>   <span class="va">dl2</span><span class="op">$</span><span class="va">inventors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">inventor_name_last</span>, <span class="va">inventor_name_first</span><span class="op">)</span></span>
<span></span>
<span><span class="va">actual_inventors</span></span>
<span><span class="co">#&gt;             inventor_id inventor_name_first inventor_name_last</span></span>
<span><span class="co">#&gt; 1  fl:th_ln:jefferson-1              Thomas          Jefferson</span></span>
<span><span class="co">#&gt; 2 fl:ge_ln:washington-4              George         Washington</span></span>
<span><span class="co">#&gt; 3 fl:ge_ln:washington-5      George Elliott         Washington</span></span></code></pre></div>
<p>Now, with actual_inventors’ inventor_ids in hand, we’ll ask the
patent endpoint for their patents. The results are quite different than
what the first query returned. (These patents would have names matching
at least one of our two famous forefathers. The first query
non-intuitively matched names where the first and last name matches did
not necessarily both occur on the same inventor.)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id_query</span> <span class="op">&lt;-</span> <span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>inventors.inventor_id<span class="op">=</span><span class="va">actual_inventors</span><span class="op">$</span><span class="va">inventor_id</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We need to pass fields since we're sorting (sort field has to be passed as a field)</span></span>
<span><span class="co"># Without a sort we could rely on the default fields being returned if we liked</span></span>
<span></span>
<span><span class="va">patent_fields</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span>, <span class="st">"inventors.inventor_name_first"</span>, <span class="st">"inventors.inventor_name_last"</span><span class="op">)</span></span>
<span><span class="va">pat_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_pv.html">search_pv</a></span><span class="op">(</span><span class="va">id_query</span>, fields<span class="op">=</span><span class="va">patent_fields</span>, sort<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patent_id"</span> <span class="op">=</span> <span class="st">"asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unnest_pv_data.html">unnest_pv_data</a></span><span class="op">(</span><span class="va">pat_res</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Also, the API's sort on patent_id, a string field, puts 10568228 first at the time of </span></span>
<span><span class="co"># this writing.  Would that be a bug or feature?  Below we'll apply our own sort</span></span>
<span><span class="va">dl</span><span class="op">$</span><span class="va">patents</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "10568228"</span></span>
<span></span>
<span><span class="co"># we'll repeat the same filter we used on the first query's results</span></span>
<span><span class="va">display_inventors</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">dl</span><span class="op">$</span><span class="va">inventors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^(George|Thomas)"</span>, <span class="va">inventor_name_first</span> <span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^(Washington|Jefferson)"</span>, <span class="va">inventor_name_last</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">patent_id</span><span class="op">)</span>, <span class="va">patent_id</span><span class="op">)</span>  <span class="co"># numeric sort on a string field</span></span>
<span></span>
<span></span>
<span><span class="va">display_inventors</span></span>
<span><span class="co">#&gt;    patent_id inventor_name_first inventor_name_last</span></span>
<span><span class="co">#&gt; 1    4078607              Thomas          Jefferson</span></span>
<span><span class="co">#&gt; 2    4104193              Thomas          Jefferson</span></span>
<span><span class="co">#&gt; 3    5643452              George         Washington</span></span>
<span><span class="co">#&gt; 4    5645778              George         Washington</span></span>
<span><span class="co">#&gt; 5    5736046              George         Washington</span></span>
<span><span class="co">#&gt; 6    5897817              George         Washington</span></span>
<span><span class="co">#&gt; 7    6218441              George         Washington</span></span>
<span><span class="co">#&gt; 8    6881337              George         Washington</span></span>
<span><span class="co">#&gt; 9    7144505              George         Washington</span></span>
<span><span class="co">#&gt; 10  10568228      George Elliott         Washington</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="subtle-exceptions">Subtle Exceptions<a class="anchor" aria-label="anchor" href="#subtle-exceptions"></a>
</h2>
<p>It’s not directly mentioned, but toward the top of the notebook, the
publication/rel_app_text endpoint appears in the special_keys hash. Its
entity is a rel_app_text_publications. There’s a similar
patent/rel_app_text endpoint whose entity is rel_app_texts. Generally
the entity is the plural form of the singular endpoint, special_keys
lists the exceptions to that rule, as the code shows.</p>
</div>
<div class="section level2">
<h2 id="acknowledgment">Acknowledgment<a class="anchor" aria-label="anchor" href="#acknowledgment"></a>
</h2>
<p>Again, credit goes to the Patentsview API team for creating the cited
jupyter notebook. This is just portions of it in R package form. The
repo didn’t have a stated license but <a href="https://patentsview.org/contact" class="external-link uri">https://patentsview.org/contact</a> says</p>
<blockquote>
<p>Users are free to use, share, or adapt the material for any purpose,
subject to the standards of the <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">Creative Commons
Attribution 4.0 International License</a>.</p>
</blockquote>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Baker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
