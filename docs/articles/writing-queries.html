<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="patentsview">
<title>Writing queries • patentsview</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Writing queries">
<meta property="og:description" content="patentsview">
<meta property="og:image" content="https://mustberuss.github.io/patentsview/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">patentsview</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--api-changes">
    <span class="fa fa-flag"></span>
     
    API Changes
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--api-changes">
    <a class="dropdown-item" href="../articles/api-changes.html">
      <span class="fa fa-exclamation"></span>
       
      2024 API Changes
    </a>
    <a class="dropdown-item" href="../articles/converting-an-existing-script.html">
      <span class="fa fa-sync"></span>
       
      Converting an Existing Script
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/getting-started.html">
    <span class="fa fa-play"></span>
     
    Getting started
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/writing-queries.html">
    <span class="fa fa-pencil"></span>
     
    Writing queries
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--applications">
    <span class="fa fa-bar-chart"></span>
     
    Applications
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--applications">
    <a class="dropdown-item" href="../articles/examples.html">
      <span class="fa fa-code"></span>
       
      Examples
    </a>
    <a class="dropdown-item" href="../articles/top-assignees.html">
      <span class="fa fa-university"></span>
       
      Top assignees
    </a>
    <a class="dropdown-item" href="../articles/citation-networks.html">
      <span class="fa fa-long-arrow-left"></span>
       
      Citation networks
    </a>
    <a class="dropdown-item" href="../articles/ropensci_blog_post.html">
      <span class="fa fa-bullhorn"></span>
       
      ropensci announcement
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/patentsview/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Writing queries</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/patentsview/blob/HEAD/vignettes/writing-queries.Rmd" class="external-link"><code>vignettes/writing-queries.Rmd</code></a></small>
      <div class="d-none name"><code>writing-queries.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="three-ways-to-write-the-same-query">Three ways to write the same query<a class="anchor" aria-label="anchor" href="#three-ways-to-write-the-same-query"></a>
</h2>
<p>Let’s say you want to find all patents published in the last 10 years
that have the word “dog” in their titles or abstracts, and whose
assignees are located in either the US or Canada. Here are three ways
you could write such a query:</p>
<ol style="list-style-type: decimal">
<li>Use a string:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query_v_1</span> <span class="op">&lt;-</span></span>
<span>  <span class="st">'{"_and":[</span></span>
<span><span class="st">          {"_gte":{"patent_date":"2007-03-01"}},</span></span>
<span><span class="st">          {"_or":[</span></span>
<span><span class="st">            {"_contains":{"patent_title":"dog"}},</span></span>
<span><span class="st">            {"_text_all":{"patent_abstract":"dog"}}</span></span>
<span><span class="st">          ]},</span></span>
<span><span class="st">          {"_or":[</span></span>
<span><span class="st">            {"_text_phrase":{"inventors.inventor_country":"US"}},</span></span>
<span><span class="st">            {"_text_phrase":{"inventors.inventor_country":"CA"}}</span></span>
<span><span class="st">          ]}</span></span>
<span><span class="st">  ]}'</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Use a list:</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query_v_2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"_and"</span> <span class="op">=</span> </span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"_gte"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2007-03-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"_or"</span> <span class="op">=</span> </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"_contains"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>patent_title <span class="op">=</span> <span class="st">"dog"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"_text_all"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="st">"dog"</span><span class="op">)</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span>               <span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"_or"</span> <span class="op">=</span> </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"_text_phrase"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inventors.inventor_country <span class="op">=</span> <span class="st">"US"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"_text_phrase"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inventors.inventor_country <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span>               <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Use the <code>patentsview</code> domain specific language
(DSL):</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mustberuss.github.io/patentsview/index.html">patentsview</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">query_v_3</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>    <span class="fu">and</span><span class="op">(</span></span>
<span>      <span class="fu">gte</span><span class="op">(</span>patent_date <span class="op">=</span> <span class="st">"2007-03-01"</span><span class="op">)</span>,</span>
<span>      <span class="fu">or</span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span>patent_title <span class="op">=</span> <span class="st">"dog"</span><span class="op">)</span>,</span>
<span>        <span class="fu">text_all</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="st">"dog"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu">or</span><span class="op">(</span></span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventors.inventor_country <span class="op">=</span> <span class="st">"US"</span><span class="op">)</span>,</span>
<span>        <span class="fu">text_phrase</span><span class="op">(</span>inventors.inventor_country <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="why-use-the-dsl">Why use the DSL?<a class="anchor" aria-label="anchor" href="#why-use-the-dsl"></a>
</h2>
<p>We can see that all three versions of the query shown above are
equivalent:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/prettify.html" class="external-link">minify</a></span><span class="op">(</span><span class="va">query_v_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_and":[{"_gte":{"patent_date":"2007-03-01"}},{"_or":[{"_contains":{"patent_title":"dog"}},{"_text_all":{"patent_abstract":"dog"}}]},{"_or":[{"_text_phrase":{"inventors.inventor_country":"US"}},{"_text_phrase":{"inventors.inventor_country":"CA"}}]}]}</span></span>
<span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">query_v_2</span>, auto_unbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_and":[{"_gte":{"patent_date":"2007-03-01"}},{"_or":[{"_contains":{"patent_title":"dog"}},{"_text_all":{"patent_abstract":"dog"}}]},{"_or":[{"_text_phrase":{"inventors.inventor_country":"US"}},{"_text_phrase":{"inventors.inventor_country":"CA"}}]}]}</span></span>
<span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">query_v_3</span>, auto_unbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_and":[{"_gte":{"patent_date":"2007-03-01"}},{"_or":[{"_contains":{"patent_title":"dog"}},{"_text_all":{"patent_abstract":"dog"}}]},{"_or":[{"_text_phrase":{"inventors.inventor_country":"US"}},{"_text_phrase":{"inventors.inventor_country":"CA"}}]}]}</span></span></code></pre></div>
<p>…So why would you ever want to use method 3 over methods 1 or 2?
There are two main reasons:</p>
<div class="section level4">
<h4 id="query-validation">1. Query validation<a class="anchor" aria-label="anchor" href="#query-validation"></a>
</h4>
<p><code><a href="../reference/search_pv.html">search_pv()</a></code> will check your query for errors if you use
methods 2 or 3. This is not the case for method 1, where you would have
to rely on the API’s error messages for guidance if your query is
invalid. <code><a href="../reference/search_pv.html">search_pv()</a></code> checks queries for the following:</p>
<ul>
<li>The fields included in your query are <em>queryable</em> for the
endpoint (i.e., the field can be used in the user query). For example,
it would make sure that <code>assingee_country</code> can be used in the
query argument if you sent the above query to the patent endpoint.</li>
<li>The fields in your query are compatible with the comparison
operators you used. For example, it would confirm that the
<code>text_all</code> operator was used with a field whose type was
“full text” (<code>patent_title</code> above).</li>
<li>You supplied the correct value type for the field (e.g.,
<code>patent_date</code> is a character, not an integer).</li>
</ul>
</div>
<div class="section level4">
<h4 id="concise-easy-to-use-syntax-for-complex-queries">2. Concise, easy to use syntax for complex queries<a class="anchor" aria-label="anchor" href="#concise-easy-to-use-syntax-for-complex-queries"></a>
</h4>
<p>Methods 1 and 3 are both shorter than method 2, making them quicker.
It’s also a lot easier to get the JSON syntax correct when using method
3 compared to method 1, because you don’t have to write any JSON at all
using the DSL…This is important because the API is fairly picky about
the query syntax, so it’s not trivial to get it correct. For example,
the API will throw an error if you use a box in your JSON when is not
absolutely necessary, even if your query is still valid JSON (e.g.,
<code>query = {"_gte":{"patent_date":["2007-03-01"]}}</code> will throw
an error).</p>
<p>Compared to method 1, method 3 will correctly “or” together values if
you put them in a vector. For example, in the query shown above, a
vector of two values was given for <code>assingee_country</code>
(<code>c("US", "CA")</code>). This safely converted the single “equals”
statement in the third element of the query
(<code>eq(assingee_country = c("US", "CA"))</code>) to two separate
equals statements that got or’d together.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;One may note that using “value arrays” is supposedly
supported by the API. For example, the API documentation gives the
following query as an example of their use:
&lt;code&gt;'{&quot;inventor_last_name&quot;:[&quot;Whitney&quot;,&quot;Hopper&quot;]}'&lt;/code&gt;. The problem
with this is that the API is not consistent in its handling of value
arrays. For many of the comparison operators, one cannot “or” together
values like this using arrays. Thus, the DSL in &lt;code&gt;patentsview&lt;/code&gt;
never relies on arrays when creating queries.&lt;/p&gt;"><sup>1</sup></a></p>
</div>
</div>
<div class="section level2">
<h2 id="basics-of-the-language">Basics of the language<a class="anchor" aria-label="anchor" href="#basics-of-the-language"></a>
</h2>
<p>All of the functions that make up the DSL are found in the
<code>qry_funs</code> list (e.g., <code>qry_funs$eq()</code>). You can
evaluate code in the context of this list using the function
<code><a href="../reference/with_qfuns.html">with_qfuns()</a></code> (see <code>?with_qfuns()</code> for an example
that demonstrates how <code><a href="../reference/with_qfuns.html">with_qfuns()</a></code> can save you typing).
There are three types of functions in <code>qry_funs</code>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Comparison operator functions</strong> (<code>eq</code>,
<code>neq</code>, <code>gt</code>, <code>gte</code>, <code>lt</code>,
<code>lte</code>, <code>begins</code>, <code>contains</code>,
<code>text_all</code>, <code>text_any</code>, <code>text_phrase</code>).
These functions are used to compare a field to a value. For example,
using the “less than or equal to” function (<code>lte</code>), we can
filter out patents published after some date (e.g.,
<code>query = qry_funs$lte(patent_date = "2001-01-05")</code>). See the
“comparison operators” section of the API’s <a href="https://search.patentsview.org/docs/docs/Search%20API/SearchAPIReference/#api-query-language" class="external-link">query
language page</a> for a description of the 11 comparison operators. One
important thing to keep in mind is that certain comparison operators
only work with certain data types. For example, you can’t use the
<code>begins</code> function on <code>patent_abstract</code> because
<code>patent_abstract</code> is of data type “full text” and
<code>begins</code> only works with fields of data type “string.”</li>
<li>
<strong>Array functions</strong> (<code>and</code> and
<code>or</code>). You can use these functions to logically combine your
calls to the comparison operators. For example, we can require that the
patent date is less than or equal to 2001-01-05 <em>and</em> the
inventor’s last name is “Ihaka”
(<code>query = with_qfuns(and(lte(patent_date = "2001-01-05"), eq(inventor_last_name = "Ihaka")))</code>).</li>
<li>
<strong>not function</strong> (<code>not</code>). This function
negates a comparison. For example, we could search for patents that
don’t have the word “hi” in their titles like this:
<code>qry_funs$not(qry_funs$text_phrase(patent_title = "hi"))</code>.</li>
</ol>
</div>
<div class="section level2">
<h2 id="query-examples">Query examples<a class="anchor" aria-label="anchor" href="#query-examples"></a>
</h2>
<p>Query the assignee endpoint for disambiguated assignees with 10 or
fewer patents:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">qry_funs</span><span class="op">$</span><span class="fu">lte</span><span class="op">(</span>assignee_num_inventors.num_inventors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_lte":{"assignee_num_inventors.num_inventors":10}}</span></span></code></pre></div>
<p>The remaining examples are queries intended for the patent
endpoint.</p>
<p>Patents assigned to the “CPC class” of G12 (physics instruments):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qry_funs</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span>cpc_current.cpc_class_id <span class="op">=</span> <span class="st">"G12"</span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_eq":{"cpc_current.cpc_class_id":"G12"}}</span></span></code></pre></div>
<p>Patents that:</p>
<ul>
<li>Have an inventor listed on them whose first name is “kevin” AND</li>
<li>Have an abstract containing either the phrase “dog bark” or “cat
meow” AND</li>
<li>Have an abstract that doesn’t have the phrase “dog chain” in
it:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>  <span class="fu">and</span><span class="op">(</span></span>
<span>    <span class="fu">text_any</span><span class="op">(</span>inventors.inventor_name_first <span class="op">=</span> <span class="st">"kevin"</span><span class="op">)</span>,  <span class="co"># inventor names are now full text</span></span>
<span>    <span class="fu">text_phrase</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dog bark"</span>, <span class="st">"cat meow"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">not</span><span class="op">(</span></span>
<span>      <span class="fu">text_phrase</span><span class="op">(</span>patent_abstract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dog chain"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_and":[{"_text_any":{"inventors.inventor_name_first":"kevin"}},{"_or":[{"_text_phrase":{"patent_abstract":"dog bark"}},{"_text_phrase":{"patent_abstract":"cat meow"}}]},{"_not":{"_text_phrase":{"patent_abstract":"dog chain"}}}]}</span></span></code></pre></div>
<p>Patents that:</p>
<ul>
<li>Have an inventor listed on them whose last name is “Smith” AND</li>
<li>Have “cotton gin” in their title</li>
</ul>
<p>OR</p>
<ul>
<li>Have an inventor listed on them whose last name is “Turner” AND</li>
<li>Have “COBOL” in their title</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/with_qfuns.html">with_qfuns</a></span><span class="op">(</span></span>
<span>  <span class="fu">or</span><span class="op">(</span></span>
<span>    <span class="fu">and</span><span class="op">(</span></span>
<span>      <span class="fu">eq</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Smith"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span>patent_title <span class="op">=</span> <span class="st">"cotton gin"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu">and</span><span class="op">(</span></span>
<span>      <span class="fu">eq</span><span class="op">(</span>inventors.inventor_name_last <span class="op">=</span> <span class="st">"Turner"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span>patent_title <span class="op">=</span> <span class="st">"COBOL"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; {"_or":[{"_and":[{"_eq":{"inventors.inventor_name_last":"Smith"}},{"_contains":{"patent_title":"cotton gin"}}]},{"_and":[{"_eq":{"inventors.inventor_name_last":"Turner"}},{"_contains":{"patent_title":"COBOL"}}]}]}</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Baker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
