---
title: "Examples"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Examples}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



## Recent API Change

With the recent [API changes](api-changes.html), the patents endpoint is the main way to retrieve data. The other 
endpoints supply additional information.  Also note that an API key is required.

## Patents endpoint

Which patents have been cited by more than 500 US patents?


```r
library(patentsview)

search_pv(query = qry_funs$gt(patent_num_times_cited_by_us_patents = 500))
#> $data
#> #### A list with a single data frame on patents level:
#> 
#> List of 1
#>  $ patents:'data.frame':	1000 obs. of  3 variables:
#>   ..$ patent_id   : chr [1:1000] "10004497" ...
#>   ..$ patent_title: chr [1:1000] "Interface systems for use with surgical ins"..
#>   ..$ patent_date : chr [1:1000] "2018-06-26" ...
#> 
#> $query_results
#> #### Distinct entity counts across all downloadable pages of output:
#> 
#> total_hits = 10,280
```

How many distinct inventors are represented by these highly-cited patents?


```r

search_pv(
  query = qry_funs$gt(patent_num_times_cited_by_us_patents = 500),
  fields = c("patent_id", "inventors.inventor_id")
)
#> $data
#> #### A list with a single data frame (with list column(s) inside) on patents level:
#> 
#> List of 1
#>  $ patents:'data.frame':	1000 obs. of  2 variables:
#>   ..$ patent_id: chr [1:1000] "10004497" ...
#>   ..$ inventors:List of 1000
#> 
#> $query_results
#> #### Distinct entity counts across all downloadable pages of output:
#> 
#> total_hits = 10,280
```
What assignee's organizations start Microsoft?


```r
query <- qry_funs$begins(assignee_organization = "Microsoft")

pv_out <- search_pv(query, endpoint = "assignees")
pv_out$data$assignees$assignee_organization
#>  [1] "Microsoft Corporation"                           
#>  [2] "Microsoft Orthopedics Holdings Inc."             
#>  [3] "Microsoft Systems Inc."                          
#>  [4] "Microsoft Mobile Internet AB"                    
#>  [5] "Microsoft Technology Licensing, LLC"             
#>  [6] "MICROSOFT CORPORAT"                              
#>  [7] "Microsoft Israel Research and Development (2002)"
#>  [8] "Microsoft International Holdings B.V."           
#>  [9] "MICROSOFT MOBILE OY"                             
#> [10] "Microsoft Technology Learning, LLC"              
#> [11] "Microsoft Corporation Microsoft Patent Group"
```

Where geographically have Microsoft inventors been coming from over the past few years?


```r
# Write the query
query <- with_qfuns(
  and(
    gte(patent_date = "2019-07-30"), # Dates are in yyyy-mm-dd format
    begins(assignees.assignee_organization = "Microsoft Corporat")
  )
)

# Create a field list
inv_fields <- get_fields(endpoint = "patents", groups = "inventors")
fields <- c(inv_fields, "patent_id")

# Pull the data
pv_out <- search_pv(query, fields = fields, all_pages = TRUE, per_page = 1000)

# Unnest the inventor list column
unnest_pv_data(pv_out$data, "patent_id")
#> List of 2
#>  $ inventors:'data.frame':	552 obs. of  8 variables:
#>   ..$ patent_id          : chr [1:552] "10402446" ...
#>   ..$ inventor           : chr [1:552] "https://search.patentsview.org/api/v1"..
#>   ..$ inventor_name_first: chr [1:552] "Ankush" ...
#>   ..$ inventor_name_last : chr [1:552] "Bindlish" ...
#>   ..$ inventor_city      : chr [1:552] "Bellevue" ...
#>   ..$ inventor_state     : chr [1:552] "WA" ...
#>   ..$ inventor_country   : chr [1:552] "US" ...
#>   ..$ inventor_sequence  : int [1:552] 3 1 ...
#>  $ patents  :'data.frame':	118 obs. of  1 variable:
#>   ..$ patent_id: chr [1:118] "10402446" ...
```

Which inventors have Chicago, IL listed as their location on at least one patent.[^1]


```r
pv_out <- search_pv(
  query = '{"_and":[{"_text_phrase": {"inventors.city":"Chicago"}},{"_text_phrase": {"inventors.state":"IL"}}]}',
  endpoint = "patents"
)

pv_out
#> $data
#> #### A list with a single data frame on patents level:
#> 
#> List of 1
#>  $ patents: list()
#> 
#> $query_results
#> #### Distinct entity counts across all downloadable pages of output:
#> 
#> total_hits = 0

if (pv_out$query_results$total_hits == 0) {
  print("something seems to be wrong with the API")
}
#> [1] "something seems to be wrong with the API"
```

Which assignees have an interest in beer?


```r
search_pv(
  query = qry_funs$contains(patent_title = "beer"),
  endpoint = "patents"
)
#> $data
#> #### A list with a single data frame on patents level:
#> 
#> List of 1
#>  $ patents:'data.frame':	553 obs. of  3 variables:
#>   ..$ patent_id   : chr [1:553] "10000326" ...
#>   ..$ patent_title: chr [1:553] "Plastic beer keg" ...
#>   ..$ patent_date : chr [1:553] "2018-06-19" ...
#> 
#> $query_results
#> #### Distinct entity counts across all downloadable pages of output:
#> 
#> total_hits = 553
```

[^1]: Example taken from https://patentsview.org/apis/api-endpoints/inventors.
